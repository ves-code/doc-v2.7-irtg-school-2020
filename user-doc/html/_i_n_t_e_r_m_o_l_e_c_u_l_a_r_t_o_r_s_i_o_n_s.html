<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: INTERMOLECULARTORSIONS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7b</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_i_n_t_e_r_m_o_l_e_c_u_l_a_r_t_o_r_s_i_o_n_s.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">INTERMOLECULARTORSIONS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the crystallization <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=crystallization . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Calculate torsion angles between vectors on adjacent molecules</p>
<p>This variable can be used to calculate the average torsional angles between vectors. In other words, it can be used to compute quantities like this:</p>
<p class="formulaDsp">
\[ s = \frac{ \sum_{i \ne j} \sigma(r_{ij}) \theta_{ij} }{ \sum_{i \ne j} \sigma(r_{ij}) } \]
</p>
<p>Here the sums run over all pairs of molecules. \(\sigma(r_{ij})\) is a <a class="el" href="switchingfunction.html">switchingfunction</a> that action on the distance between the centers of molecules \(i\) and \(j\). \(\theta_{ij}\) is then the torsional angle between an orientation vector for molecule \(i\) and molecule \(j\).</p>
<p>This command can be used to calculate the intermolecular torsional angles between the orientations of nearby molecules. The orientation of a molecule can be calculated by using either the <a class="el" href="_m_o_l_e_c_u_l_e_s.html">MOLECULES</a> or the <a class="el" href="_p_l_a_n_e_s.html">PLANES</a> commands. These two commands calculate the orientation of a bond in the molecule or the orientation of a plane containing three of the molecule's atoms. Furthermore, when we use these commands we think of molecules as objects that lie at a point in space and that have an orientation. This command calculates the torsional angles between the orientations of these objects. We can then calculates functions of a large number of these torsional angles that measures things such as the number of torsional angles that are within a particular range. Because it is often useful to only consider the torsional angles between objects that are within a certain distance of each other we can, when calculating these sums, perform a weighted sum and use a <a class="el" href="switchingfunction.html">switchingfunction</a> to ensure that we focus on molecules that are close together.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The example input below is necessarily but gives you an idea of what can be achieved using this action. The orientations and positions of four molecules are defined using the <a class="el" href="_m_o_l_e_c_u_l_e_s.html">MOLECULES</a> action as the position of the centers of mass of the two atoms specified and the direction of the vector connecting the two atoms that were specified. The torsional angles between the molecules are then calculated by the <a class="el" href="_i_n_t_e_r_m_o_l_e_c_u_l_a_r_t_o_r_s_i_o_n_s.html">INTERMOLECULARTORSIONS</a> command labelled torsion_p. We then compute a <a class="el" href="_h_i_s_t_o_g_r_a_m.html">HISTOGRAM</a> that shows the distribution that these torsional angles take in the structure. The weight a given torsional angle contributes to this <a class="el" href="_h_i_s_t_o_g_r_a_m.html">HISTOGRAM</a> is determined using a <a class="el" href="switchingfunction.html">switchingfunction</a> that acts on the distance between the two molecules. As such the torsional angles between molecules that are close together contribute a high weight to the histogram while the torsional angles between molecules that are far apart does not contribute to the histogram. The histogram is averaged over the whole trajectory and output once all the trajectory frames have been read.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1m1" onclick='showPath("eg1","eg1m1")'>m1: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_o_l_e_c_u_l_e_s.html" style="color:green">MOLECULES</a> <div class="tooltip">MOL1<div class="right">The numerical indices of the atoms in the molecule. <i></i></div></div>=1,2 <div class="tooltip">MOL2<div class="right">The numerical indices of the atoms in the molecule. <i></i></div></div>=3,4 <div class="tooltip">MOL3<div class="right">The numerical indices of the atoms in the molecule. <i></i></div></div>=5,6 <div class="tooltip">MOL4<div class="right">The numerical indices of the atoms in the molecule. <i></i></div></div>=7,8 <span style="display:none;" id="eg1m1">The MOLECULES action with label <b>m1</b></span>
<b name="eg1torsion_p" onclick='showPath("eg1","eg1torsion_p")'>torsion_p: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_i_n_t_e_r_m_o_l_e_c_u_l_a_r_t_o_r_s_i_o_n_s.html" style="color:green">INTERMOLECULARTORSIONS</a> <div class="tooltip">MOLS<div class="right">The molecules you would like to calculate the torsional angles between. <i></i></div></div>=<b name="eg1m1">m1</b> <div class="tooltip">SWITCH<div class="right">This keyword is used if you want to employ an alternative to the continuous switching
function defined above. <i></i></div></div>={RATIONAL R_0=0.25 D_0=2.0 D_MAX=3.0}  <span style="display:none;" id="eg1torsion_p">The INTERMOLECULARTORSIONS action with label <b>torsion_p</b> calculates a single scalar value</span>
<b name="eg1htt_p" onclick='showPath("eg1","eg1htt_p")'>htt_p: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">DATA<div class="right">input data from action with vessel and compute histogram <i></i></div></div>=<b name="eg1torsion_p">torsion_p</b> <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=-pi <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=pi <div class="tooltip">BANDWIDTH<div class="right"><b>compulsory keyword </b>
the bandwidths for kernel density estimation <i></i></div></div>=0.1 <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=200 <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=1 <span style="display:none;" id="eg1htt_p">The HISTOGRAM action with label <b>htt_p</b></span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the grid you would like to output <i></i></div></div>=<b name="eg1htt_p">htt_p</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=density )</b>
the file on which to write the grid. <i></i></div></div>=myhist.out <span style="display:none;" id="eg1">The DUMPGRID action with label <b></b></span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> MOLS </b> </td><td>The molecules you would like to calculate the torsional angles between. This should be the label/s of <a class="el" href="_m_o_l_e_c_u_l_e_s.html">MOLECULES</a> or <a class="el" href="_p_l_a_n_e_s.html">PLANES</a> actions. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
</table>
<dl class="section user"><dt>Or alternatively by using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> MOLSA </b> </td><td>In this version of the input the torsional angles between all pairs of atoms including one atom from MOLSA one atom from MOLSB will be computed. This should be the label/s of <a class="el" href="_m_o_l_e_c_u_l_e_s.html">MOLECULES</a> or <a class="el" href="_p_l_a_n_e_s.html">PLANES</a> actions   </td></tr>
<tr>
<td width="15%"><b> MOLSB </b> </td><td>In this version of the input the torsional angles between all pairs of atoms including one atom from MOLSA one atom from MOLSB will be computed. This should be the label/s of <a class="el" href="_m_o_l_e_c_u_l_e_s.html">MOLECULES</a> or <a class="el" href="_p_l_a_n_e_s.html">PLANES</a> actions   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NN </b> </td><td>( default=6 ) The n parameter of the switching function   </td></tr>
<tr>
<td width="15%"><b> MM </b> </td><td>( default=0 ) The m parameter of the switching function; 0 implies 2*NN   </td></tr>
<tr>
<td width="15%"><b> D_0 </b> </td><td>( default=0.0 ) The d_0 parameter of the switching function   </td></tr>
<tr>
<td width="15%"><b> R_0 </b> </td><td>The r_0 parameter of the switching function   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not use MPI   </td></tr>
<tr>
<td width="15%"><b> TIMINGS </b> </td><td>( default=off ) output information on the timings of the various parts of the calculation   </td></tr>
<tr>
<td width="15%"><b> LOWMEM </b> </td><td><p class="starttd">( default=off ) lower the memory requirements  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> SWITCH </b> </td><td>This keyword is used if you want to employ an alternative to the continuous switching function defined above. The following provides information on the <a class="el" href="switchingfunction.html">switchingfunction</a> that are available. When this keyword is present you no longer need the NN, MM, D_0 and R_0 keywords.   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="mcolv.html">MultiColvar</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
