<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: Lugano tutorial: Brief guide to PLUMED syntax and analyzing trajectories</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7b</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('lugano-1.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Lugano tutorial: Brief guide to PLUMED syntax and analyzing trajectories </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="lugano-1-aims"></a>
Aims</h1>
<p>The aim of this tutorial is to introduce you to the PLUMED syntax. We will go through the writing of input files to calculate and print simple collective variables on a pre-calculated trajectory.</p>
<h1><a class="anchor" id="lugano-1-lo"></a>
Learning Outcomes</h1>
<p>Once this tutorial is completed, students will be able to:</p>
<ul>
<li>Write a simple PLUMED input file and use it with the PLUMED <a class="el" href="driver.html">driver</a> to analyze a trajectory.</li>
<li>Print collective variables such as distances. (<a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a>), torsional angles (<a class="el" href="_t_o_r_s_i_o_n.html">TORSION</a>), gyration radius (<a class="el" href="_g_y_r_a_t_i_o_n.html">GYRATION</a>), and RMSD (<a class="el" href="_r_m_s_d.html">RMSD</a>) using the <a class="el" href="_p_r_i_n_t.html">PRINT</a> action.</li>
<li>Use <a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a> shortcuts.</li>
<li>Define and use virtual atoms, such as <a class="el" href="_c_e_n_t_e_r.html">CENTER</a>.</li>
<li>Take care of periodic boundary conditions within PLUMED using <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> and be able to verify the result with <a class="el" href="_d_u_m_p_a_t_o_m_s.html">DUMPATOMS</a>.</li>
<li>Write their own CVs directly in the input file using the <a class="el" href="_c_u_s_t_o_m.html">CUSTOM</a> action.</li>
</ul>
<h1><a class="anchor" id="lugano-1-install"></a>
Install PLUMED</h1>
<p>You can find detailed instructions about how to install PLUMED here:</p>
<pre class="fragment">https://github.com/plumed/conda
</pre><h1><a class="anchor" id="lugano-1-resources"></a>
Resources</h1>
<p>Before starting the tutorial, please create a separate directory, named <code>hands_on_1</code>, and enter it: </p><pre class="fragment">mkdir hands_on_1
cd hands_on_1
</pre><p>The reference trajectories and other files needed for the exercises proposed in this tutorial can be downloaded from <code>github</code> using the following command:</p>
<pre class="fragment">wget https://github.com/plumed/lugano2019/raw/master/handson_1/handson_1.tgz 
</pre><p>The zip archive contains the following files:</p><ul>
<li>GB1_native.pdb : A PDB file with the native structure of the GB1 protein.</li>
<li>traj-whole.xtc: A trajectory in xtc format. To make the exercise easier, GB1 has been made whole already.</li>
<li>traj-broken.xtc: The same trajectory as it was originally produced by GROMACS. Here GB1 is broken by periodic boundary conditions and should be fixed.</li>
</ul>
<p>The archive can be opened with the following command: </p><pre class="fragment">tar xvzf handson_1.tgz
</pre><p>This tutorial has been tested on PLUMED version 2.6.0</p>
<h1><a class="anchor" id="lugano-1-instructions"></a>
Instructions</h1>
<p>PLUMED is a library that can be incorporated into many MD codes by adding a relatively simple and well documented interface. Once it is incorporated you can use PLUMED to perform a variety of different analyzes on the fly and to bias the sampling in the molecular dynamics engine. PLUMED can also, however, be used as a standalone code for analyzing trajectories. If you are using the code in this way you can, once PLUMED is compiled, run the plumed executable by issuing the command:</p>
<pre class="fragment">plumed &lt;instructions&gt;
</pre><p>Let's start by getting a feel for the range of calculations that we can use PLUMED to perform. Issue the following command now:</p>
<pre class="fragment">plumed --help 
</pre><p>What is output when this command is run is a list of the tasks you can use PLUMED to perform. There are commands that allow you to patch an MD code, commands that allow you to run molecular dynamics and commands that allow you to build the manual. In this tutorial we will mostly be using PLUMED to analyze trajectories, however. As such most of the calculations we will perform will be performed using the driver tool. Let's look at the options we can issue to plumed driver by issuing the following command: <br  />
</p>
<pre class="fragment">plumed driver --help
</pre><p>As you can see we can do a number of things with plumed driver. For all of these options, however, we are going to need to write a PLUMED input file. The syntax of the PLUMED input file is the same that we will use later to run enhanced sampling simulations, so all the things that you will learn now will be useful later when you will run PLUMED coupled to an MD code. In the following we are going to see how to write an input file for PLUMED.</p>
<h2><a class="anchor" id="lugano-1-units"></a>
The PLUMED internal units</h2>
<p>By default the PLUMED inputs and outputs quantities in the following units:</p>
<ul>
<li>Energy - kJ/mol</li>
<li>Length - nanometers</li>
<li>Time - picoseconds</li>
</ul>
<p>If you want to change these units you can do this using the <a class="el" href="_u_n_i_t_s.html">UNITS</a> keyword.</p>
<h1><a class="anchor" id="lugano-1-structure"></a>
The syntax of the PLUMED input file</h1>
<p>The main goal of PLUMED is to compute collective variables, which are complex descriptors than can be used to analyze a conformational change or a chemical reaction. This can be done either on-the-fly during molecular dynamics or a posteriori, using PLUMED as a post-processing tool. In both cases one, should create an input file with a specific PLUMED syntax. A sample input file is below:</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># Compute distance between atoms 1 and 10.</span>
<span style="color:blue"># Atoms are ordered as in the trajectory files and their numbering starts from 1.</span>
<span style="color:blue"># The distance is called "d" for future reference.</span>
<b name="eg1d" onclick='showPath("eg1","eg1d")'>d: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,10 <span style="display:none;" id="eg1d">The DISTANCE action with label <b>d</b> calculates a single scalar value</span>
<span style="color:blue"># Create a virtual atom in the center between atoms 20 and 30.</span>
<span style="color:blue"># The virtual atom only exists within PLUMED and is called "center" for future reference.</span>
<b name="eg1center" onclick='showPath("eg1","eg1center")'>center: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_e_n_t_e_r.html" style="color:green">CENTER</a> <div class="tooltip">ATOMS<div class="right">the list of atoms which are involved the virtual atom's definition. <i></i></div></div>=20,30 <span style="display:none;" id="eg1center">The CENTER action with label <b>center</b> calculates the position of a virtual atom</span>
<span style="color:blue"># Compute the torsional angle between atoms 1, 10, 20, and center.</span>
<span style="color:blue"># Notice that virtual atoms can be used as real atoms here.</span>
<span style="color:blue"># The angle is called "phi" for future reference.</span>
<b name="eg1phi1" onclick='showPath("eg1","eg1phi1")'>phi1: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=1,10,20,<b name="eg1center">center</b> <span style="display:none;" id="eg1phi1">The TORSION action with label <b>phi1</b> calculates a single scalar value</span>
<span style="color:blue"># the same CV defined before can be split into multiple line</span>
<b name="eg1phi2" onclick='showPath("eg1","eg1phi2")'>phi2: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> ...
   
   <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=1,10,20,<b name="eg1center">center</b> 
...<span style="display:none;" id="eg1phi2">The TORSION action with label <b>phi2</b> calculates a single scalar value</span>
<span style="color:blue"># Print d every 10 step on a file named "COLVAR1".</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg1d">d</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=10 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR1 <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
<span style="color:blue"># Print phi1 and phi2 on another file names "COLVAR2" every 100 steps.</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg1phi1">phi1</b>,<b name="eg1phi2">phi2</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR2 <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p>In the input file above, each line defines a so-called action. An action could either compute a distance, or the center between two or more atoms, or print some value on a file. Each action supports a number of keywords, whose value is specified. Action names are highlighted in green and, clicking on them, you can go to the corresponding page in the manual that contains a detailed description for each keyword. Actions that support the keyword <code>STRIDE</code> are those that determine how frequently things are to be done. Notice that the default value for <code>STRIDE</code> is always 1. In the example above, omitting <code>STRIDE</code> keywords the corresponding COLVAR files would have been written for every frame of the analyzed trajectory. All the other actions in the example above do not support the <code>STRIDE</code> keyword and are only calculated when requested. That is, <code>d</code> will be computed every 10 frames, and <code>phi1</code> and <code>phi2</code> every 100 frames. In short, you can think that for every snapshot in the trajectory that you are analyzing PLUMED is going to execute all the listed actions, though some of them are optimized out when <code>STRIDE</code> is different from 1.</p>
<p>Variables should be given a name (in the example above, <code>d</code>, <code>phi1</code>, and <code>phi2</code>), which is then used to refer to these variables. Lists of atoms should be provided as comma separated numbers, with no space. Virtual atoms can be created and assigned a name for later use.</p>
<p>You can find more information on the PLUMED syntax at <a class="el" href="_syntax.html">Getting Started</a> page of the manual. The complete documentation for all the supported collective variables can be found at the <a class="el" href="colvarintro.html">Collective Variables</a> page.</p>
<h1><a class="anchor" id="lugano-1-ex"></a>
Exercises</h1>
<h2><a class="anchor" id="lugano-1-ex-1"></a>
Exercise 1: Computing and printing simple collective variables</h2>
<p>In this exercise, we will make practice with computing and printing collective variables. To analyze the trajectories provided here, you should:</p><ul>
<li>Create a PLUMED input file with a text editor (let us call it <code>plumed.dat</code>) similar to the one above.</li>
<li>Run the command <code>plumed driver</code> command (see below)</li>
</ul>
<p>Notice that you can also visualize trajectories with VMD directly. For example, the trajectory <code>traj-whole.xtc</code> can be visualized with the command <code>vmd GB1_native.pdb traj-whole.xtc</code>.</p>
<p>Let's prepare a PLUMED input file that calculates</p><ul>
<li>The gyration radius of all CA protein atoms (<a class="el" href="_g_y_r_a_t_i_o_n.html">GYRATION</a>). Look in the <code>GB1_native.pdb</code> file to retrieve the list of indexes of the CA atoms.</li>
<li>The total number of contacts (<a class="el" href="_c_o_o_r_d_i_n_a_t_i_o_n.html">COORDINATION</a>) between all protein CA atoms. For <a class="el" href="_c_o_o_r_d_i_n_a_t_i_o_n.html">COORDINATION</a>, set reference distance <code>R_0</code> to 8.0 A (be careful with units!!).</li>
</ul>
<p>Here you can find a sample <code>plumed.dat</code> file that you can use as a template. Whenever you see an highlighted <span style="background-color:yellow">FILL</span> string, this is a string that you should replace.</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># Compute gyration radius on CA atoms:</span>
<b name="eg2r" onclick='showPath("eg2","eg2r")'>r: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_g_y_r_a_t_i_o_n.html" style="color:green">GYRATION</a> <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg2r"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># Compute number of contacts between CA atoms</span>
<b name="eg2co" onclick='showPath("eg2","eg2co")'>co: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_o_o_r_d_i_n_a_t_i_o_n.html" style="color:green">COORDINATION</a> <div class="tooltip">GROUPA<div class="right">First list of atoms. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">R_0<div class="right"><b> could not find this keyword </b><i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg2co"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># Print the collective variables on COLVAR file every step</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2r">r</b>,<b name="eg2co">co</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>Once your <code>plumed.dat</code> file is complete, you can use it with the following command </p><pre class="fragment">&gt; plumed driver --plumed plumed.dat --mf_xtc traj-broken.xtc
</pre><p>Scroll in your terminal to read the PLUMED log. As you can see, PLUMED gives a lot of feedback about the input that he is reading. There's the place where you can check if PLUMED understood correctly your input.</p>
<p>The command above will create a <code>COLVAR</code> file like this one: </p><pre class="fragment">#! FIELDS time r co
 0.000000 2.458704 165.184131
 1.000000 2.341932 164.546603
 2.000000 2.404708 162.606975
 3.000000 2.454297 143.850117
 4.000000 2.569342 147.110410
 5.000000 2.304027 163.608695
 6.000000 2.116676 177.549792
 7.000000 2.068599 183.177952
 8.000000 2.021605 181.929958
... more lines ...
</pre><p> Notice that the first line informs you about the content of each column.</p>
<p><b>In case you obtain different numbers, check your input, you might have made some mistake!</b></p>
<p>This file can then be visualized using the following python script: </p><pre class="fragment">import matplotlib.pyplot as plt
import plumed
colvar=plumed.read_as_pandas("COLVAR")
plt.plot(colvar.time,colvar.r)
plt.show()
plt.plot(colvar.time,colvar.co)
plt.show()
</pre><p>Now, look at what happens if you run the exercise twice. The second time, PLUMED will <em>back up</em> the previously produced file so as not to overwrite it. You can also <em>concatenate</em> your files by using the action <a class="el" href="_r_e_s_t_a_r_t.html">RESTART</a> at the beginning of your input file.</p>
<p>Finally, let's try to use the same input file with <code>traj-whole.xtc</code> and examine the results. Did you find the same results as with the previous trajectory? Why?</p>
<h2><a class="anchor" id="lugano-1-ex-2"></a>
Exercise 2:  MOLINFO shortcuts</h2>
<p>PLUMED provides some shortcuts to select atoms with specific properties. To use this feature, you should specify the <a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a> action along with a reference pdb file.</p>
<p>Let's try to use this functionality to calculate the backbone dihedral angle phi of residue 2 of GB1. This CV is defined by the action <a class="el" href="_t_o_r_s_i_o_n.html">TORSION</a> and a set of 4 atoms. For residue <code>i</code>, the dihedral phi is defined by these atoms: C(i-1),N(i),CA(i),C(i). After consulting the manual and inspecting GB1_native.pdb, let's define the dihedral angle in question in two different ways: using the <a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a> shortcut to define psi of residue 2 and with an explicit list of 4 atoms.</p>

<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># activate MOLINFO functionalities</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> <div class="tooltip">STRUCTURE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing a reference structure. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg3"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># define phi dihedral of residue 2 as a list of 4 atoms</span>
<b name="eg3t1" onclick='showPath("eg3","eg3t1")'>t1: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg3t1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># define the same dihedral using MOLINFO shortcuts</span>
<b name="eg3t2" onclick='showPath("eg3","eg3t2")'>t2: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg3t2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># print the value of t1 and t2 every 10 steps</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=10 <span style="display:none;" id="eg3"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>After completing the PLUMED input file above, let's use it to analyze the trajectory <code>traj-whole.xtc</code> that you downloaded at the start of this exercise. Now, let's plot the trajectory of the two CVs above. If you executed this exercise correctly, these two trajectories should be identical.</p>
<dl class="section note"><dt>Note</dt><dd>In the manual you can also learn how to use selections done with MDtraj or MDAnalysis. For instance, the CA atoms that you needed in <a class="el" href="lugano-1.html#lugano-1-ex-1">Exercise 1: Computing and printing simple collective variables</a> could have been picked with <code>{{@mda:name CA}}</code>.</dd></dl>
<h2><a class="anchor" id="lugano-1-ex-3"></a>
Exercise 3: Virtual atoms</h2>
<p>Sometimes, when calculating a CV, you may not want to use the positions of a number of atoms directly. Instead you may want to define a virtual atom whose position is generated based on the positions of a collection of other atoms. For example you might want to use the center of mass (<a class="el" href="_c_o_m.html">COM</a>) or the geometric center (<a class="el" href="_c_e_n_t_e_r.html">CENTER</a>) of a group of atoms.</p>
<p>In this exercise, you will learn how to specify virtual atoms and later use them to define a CV. Let's start by having a look at the PLUMED input file below.</p>

<div style="width: 90%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># geometric center of first residue</span>
<b name="eg4first" onclick='showPath("eg4","eg4first")'>first: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_e_n_t_e_r.html" style="color:green">CENTER</a> <div class="tooltip">ATOMS<div class="right">the list of atoms which are involved the virtual atom's definition. <i></i></div></div>=1,2,3,4,5,6,7,8 <span style="display:none;" id="eg4first">The CENTER action with label <b>first</b> calculates the position of a virtual atom</span>
<span style="color:blue"># geometric center of last residue</span>
<b name="eg4last" onclick='showPath("eg4","eg4last")'>last: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_e_n_t_e_r.html" style="color:green">CENTER</a> <div class="tooltip">ATOMS<div class="right">the list of atoms which are involved the virtual atom's definition. <i></i></div></div>=427-436 <span style="display:none;" id="eg4last">The CENTER action with label <b>last</b> calculates the position of a virtual atom</span>
<span style="color:blue"># distance between centers of first and last residues, with PBCs</span>
<b name="eg4d1" onclick='showPath("eg4","eg4d1")'>d1: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=<b name="eg4first">first</b>,<b name="eg4last">last</b> <span style="display:none;" id="eg4d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<span style="color:blue"># distance between centers of first and last residues, without PBCs</span>
<b name="eg4d2" onclick='showPath("eg4","eg4d2")'>d2: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=<b name="eg4first">first</b>,<b name="eg4last">last</b> <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg4d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<span style="color:blue"># print the two distances every step</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg4d1">d1</b>,<b name="eg4d2">d2</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg4">The PRINT action with label <b></b></span>
</pre>
<p>Make a PLUMED input containing the above input and execute it on the trajectory <code>traj-broken.xtc</code> by making use of the following command:</p>
<pre class="fragment">plumed driver --mf_xtc traj-broken.xtc --plumed plumed.dat
</pre><p>Before we turn to analyzing what is output from this calculation there are a few things to note about this input file. Firstly, I should describe what this file instructs PLUMED to do. It tells PLUMED to:</p>
<ol type="1">
<li>calculate the position of the Virtual Atom 'first' as the <a class="el" href="_c_e_n_t_e_r.html">CENTER</a> of atoms from 1 to 8;</li>
<li>calculate the position of the Virtual Atom 'last' as the <a class="el" href="_c_e_n_t_e_r.html">CENTER</a> of atoms from 427 to 436;</li>
<li>calculate the distance between the two Virtual Atoms 'first' and 'last' and saves it in 'd1';</li>
<li>calculate the distance (ignoring periodic boundary conditions) between the two Virtual Atom 'first' and 'last' and saves it in 'd2';</li>
<li>print the content of 'd1' and 'd2' in the file COLVAR for every frame of the trajectory</li>
</ol>
<p>Notice that in the input above we have used two different ways of writing the atoms used in the <a class="el" href="_c_e_n_t_e_r.html">CENTER</a> calculation:</p>
<ol type="1">
<li>ATOMS=1,2,3,4,5,6,7,8 is the explicit list of the atoms we need</li>
<li>ATOMS=427-436 is the range of atoms needed</li>
</ol>
<p>Notice also that ranges of atoms can be defined with a stride which can also be negative as shown by the commands below, which are both equivalent:</p>
<ol type="1">
<li>ATOMS=from,to:by (i.e.: 427-436:2)</li>
<li>ATOMS=to,from:-by (i.e.: 436-427:-2)</li>
</ol>
<p>Let's now analyze the output of the calculation by plotting the time series of the two CVs. Are they identical? What do you think is happening in those frames in which the two CVs are different?</p>
<p>You can repeat the same analysis on <code>traj-whole.xtc</code> and compare with the previous trajectory. Are the results identical? <br  />
</p>
<h2><a class="anchor" id="lugano-1-ex-4"></a>
Exercise 4: Taking care of periodic boundary conditions</h2>
<p>As you should have noticed, in this tutorial we are working with two different trajectories of the GB1 protein:</p><ul>
<li>traj-broken.xtc: the original GROMACS trajectory in which GB1 is broken by periodic boundary conditions</li>
<li>traj-whole.xtc: the trajectory processed by the <code>gmx trjconv</code> utility to fix discontinuities due to periodic boundary conditions</li>
</ul>
<p>In many PLUMED CVs, periodic boundary conditions are automatically taken into account unless a special option (NOPBC) is used. In this way, the user can work directly with the raw trajectory <code>traj-broken.xtc</code>. Alternatively, PLUMED can reconstruct internally the coordinates of the system and thus fix discontinuities due to the periodic boundary conditions. In order to do so, the <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> action should be used.</p>
<p>In this exercise, we will learn how to use the <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> action. Let's ask PLUMED to internally make the structure of GB1 whole and print the new atoms positions on a new file, called <code>dump.gro</code>, every 10 steps.</p>

<div style="width: 90%; float:left" id="value_details_eg5"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># use WHOLEMOLECULES to make the entire protein whole</span>
<span style="color:blue"># let's use the range syntax to specify all GB1 atoms</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> <div class="tooltip">ENTITY0<div class="right">the atoms that make up a molecule that you wish to align. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg5"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># print the positions of all atoms every 10 steps</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_a_t_o_m_s.html" style="color:green">DUMPATOMS</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
file on which to output coordinates; extension is automatically detected <i></i></div></div>=dump.gro <div class="tooltip">ATOMS<div class="right">the atom indices whose positions you would like to print out. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the atoms should be output <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg5"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>Once your <code>plumed.dat</code> file is complete, you can use it with the following command </p><pre class="fragment">&gt; plumed driver --plumed plumed.dat --mf_xtc traj-broken.xtc
</pre><p>and look at the output file with vmd. Have the problems with the periodic boundary conditions been fixed?</p>
<p>At this point, we can repeat <a class="el" href="lugano-1.html#lugano-1-ex-3">Exercise 3: Virtual atoms</a> after adding the <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> action at the beginning of the PLUMED input file:</p>

<div style="width: 90%; float:left" id="value_details_eg6"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># make protein whole</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> <div class="tooltip">ENTITY0<div class="right">the atoms that make up a molecule that you wish to align. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg6"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># geometric center of first residue</span>
<b name="eg6first" onclick='showPath("eg6","eg6first")'>first: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_e_n_t_e_r.html" style="color:green">CENTER</a> <div class="tooltip">ATOMS<div class="right">the list of atoms which are involved the virtual atom's definition. <i></i></div></div>=1,2,3,4,5,6,7,8 <span style="display:none;" id="eg6first"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># geometric center of last residue</span>
<b name="eg6last" onclick='showPath("eg6","eg6last")'>last: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_e_n_t_e_r.html" style="color:green">CENTER</a> <div class="tooltip">ATOMS<div class="right">the list of atoms which are involved the virtual atom's definition. <i></i></div></div>=427-436 <span style="display:none;" id="eg6last"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># distance between centers of first and last residues, with PBCs</span>
<b name="eg6d1" onclick='showPath("eg6","eg6d1")'>d1: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=<b name="eg6first">first</b>,<b name="eg6last">last</b> <span style="display:none;" id="eg6d1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># distance between centers of first and last residues, without PBCs</span>
<b name="eg6d2" onclick='showPath("eg6","eg6d2")'>d2: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=<b name="eg6first">first</b>,<b name="eg6last">last</b> <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg6d2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># print the two distances every step</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg6d1">d1</b>,<b name="eg6d2">d2</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg6"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>We can now visualize the time line of the two CVs and compare it with the results of <a class="el" href="lugano-1.html#lugano-1-ex-3">Exercise 3: Virtual atoms</a>. Which CVs are identical and which are not? Why?</p>
<h2><a class="anchor" id="lugano-1-ex-5"></a>
Exercise 5: Using CVs that measure the distance from a reference conformation</h2>
<p>In many cases, it is useful to define a CV that quantifies the distance of the system from a reference conformation. In PLUMED, this can be achieved using a variety of different CVs. Please, have a look <a href="../../user-doc/html/dists.html">here </a> for more info.</p>
<p>In this exercise, we will learn how to use the <a class="el" href="_r_m_s_d.html">RMSD</a> and <a class="el" href="_d_r_m_s_d.html">DRMSD</a> CVs. In order to do so, we need to edit a reference pdb file and identify:</p><ul>
<li>for <a class="el" href="_r_m_s_d.html">RMSD</a>, the atoms that you want to use for alignment and RMSD calculation</li>
<li>for <a class="el" href="_d_r_m_s_d.html">DRMSD</a>, the atoms that you want to use for the DRMSD calculation</li>
</ul>
<p>Please refer to the manual to understand how to specify the atoms needed to calculate the CA-RMSD and CA-DRMSD with respect to the native GB1 structure. After editing the reference pdb file, please complete the following input file:</p>

<div style="width: 90%; float:left" id="value_details_eg7"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># RMSD on CA atoms, after optimal alignment</span>
<b name="eg7rmsd" onclick='showPath("eg7","eg7rmsd")'>rmsd: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_r_m_s_d.html" style="color:green">RMSD</a> <div class="tooltip">REFERENCE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing the reference structure and the atoms involved in
the CV. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">TYPE<div class="right"><b>compulsory keyword ( default=SIMPLE )</b>
the manner in which RMSD alignment is performed. <i></i></div></div>=OPTIMAL <span style="display:none;" id="eg7rmsd"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># DRMSD on CA atoms</span>
<span style="color:blue"># Only pairs of atoms whose distance in the reference structure</span>
<span style="color:blue"># is within 0.1 and 0.8 nm are considered</span>
<b name="eg7drmsd" onclick='showPath("eg7","eg7drmsd")'>drmsd: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_r_m_s_d.html" style="color:green">DRMSD</a> <div class="tooltip">REFERENCE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing the reference structure and the atoms involved in
the CV. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">LOWER_CUTOFF<div class="right"><b>compulsory keyword </b>
only pairs of atoms further than LOWER_CUTOFF are considered in the calculation.
<i></i></div></div>=0.1 <div class="tooltip">UPPER_CUTOFF<div class="right"><b>compulsory keyword </b>
only pairs of atoms closer than UPPER_CUTOFF are considered in the calculation. <i></i></div></div>=0.8 <span style="display:none;" id="eg7drmsd"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># print both CVs to file</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg7"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>Once your <code>plumed.dat</code> file is complete, you can use it with the following command </p><pre class="fragment">&gt; plumed driver --plumed plumed.dat --mf_xtc traj-broken.xtc
</pre><p>and also on the trajectory file in which problems due to the periodic boundaries have been fixed:</p>
<pre class="fragment">&gt; plumed driver --plumed plumed.dat --mf_xtc traj-whole.xtc
</pre><p>Can you comment the results obtained and the differences - if any - between the two trajectories? What is happening to the protein during the course of the simulation? Are the two metrics, <a class="el" href="_r_m_s_d.html">RMSD</a> and <a class="el" href="_d_r_m_s_d.html">DRMSD</a>, equivalent?</p>
<h2><a class="anchor" id="lugano-1-ex-6"></a>
Exercise 6: Creating your own CV directly in the PLUMED input file</h2>
<p>In PLUMED, you can define your own CV directly in the input file by writing it as a function of existing CVs using the <a class="el" href="_c_u_s_t_o_m.html">CUSTOM</a> action. PLUMED will then automatically calculate the derivatives with the respect to the atoms positions.</p>
<p>Let's look at the following example.</p>

<div style="width: 90%; float:left" id="value_details_eg8"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># distance between atoms 10 and 12</span>
<b name="eg8dAB" onclick='showPath("eg8","eg8dAB")'>dAB: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=10,12 <span style="display:none;" id="eg8dAB">The DISTANCE action with label <b>dAB</b> calculates a single scalar value</span>
<span style="color:blue"># distance between atoms 10 and 15</span>
<b name="eg8dAC" onclick='showPath("eg8","eg8dAC")'>dAC: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=10,15 <span style="display:none;" id="eg8dAC">The DISTANCE action with label <b>dAC</b> calculates a single scalar value</span>
<span style="color:blue"># custom CV defined as the difference between dAC-&gt;y and dAB-&gt;x</span>
<b name="eg8diff" onclick='showPath("eg8","eg8diff")'>diff: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg8dAB">dAB</b>,<b name="eg8dAC">dAC</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=y-x <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg8diff">The CUSTOM action with label <b>diff</b> calculates a single scalar value</span>
<span style="color:blue"># print the 3 CVs to file every 10 steps</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg8dAB">dAB</b>,<b name="eg8dAC">dAC</b>,<b name="eg8diff">diff</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=10 <span style="display:none;" id="eg8">The PRINT action with label <b></b></span>
</pre>
<p>In this example, a custom CV is defined as the difference of two distances between pairs of atoms.</p>
<p>Please complete the following input file to calculate two new CVs from those defined in <a class="el" href="lugano-1.html#lugano-1-ex-5">Exercise 5: Using CVs that measure the distance from a reference conformation</a>:</p><ul>
<li>the average of <a class="el" href="_r_m_s_d.html">RMSD</a> and <a class="el" href="_d_r_m_s_d.html">DRMSD</a>, calculated on all the CA atoms of GB1 (easy)</li>
<li>the minimum distance between <a class="el" href="_r_m_s_d.html">RMSD</a> and <a class="el" href="_d_r_m_s_d.html">DRMSD</a> (a bit more difficult). To define this function, you can creatively take inspiration from the path CV <code>s</code> (see <a class="el" href="_p_a_t_h.html">PATH</a>).</li>
</ul>

<div style="width: 90%; float:left" id="value_details_eg9"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># RMSD on CA atoms, after optimal alignment</span>
<b name="eg9rmsd" onclick='showPath("eg9","eg9rmsd")'>rmsd: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_r_m_s_d.html" style="color:green">RMSD</a> <div class="tooltip">REFERENCE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing the reference structure and the atoms involved in
the CV. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">TYPE<div class="right"><b>compulsory keyword ( default=SIMPLE )</b>
the manner in which RMSD alignment is performed. <i></i></div></div>=OPTIMAL <span style="display:none;" id="eg9rmsd"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># DRMSD on CA atoms</span>
<span style="color:blue"># Only pairs of atoms whose distance in the reference structure</span>
<span style="color:blue"># is within 0.1 and 0.8 nm are considered</span>
<b name="eg9drmsd" onclick='showPath("eg9","eg9drmsd")'>drmsd: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_r_m_s_d.html" style="color:green">DRMSD</a> <div class="tooltip">REFERENCE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing the reference structure and the atoms involved in
the CV. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">LOWER_CUTOFF<div class="right"><b>compulsory keyword </b>
only pairs of atoms further than LOWER_CUTOFF are considered in the calculation.
<i></i></div></div>=0.1 <div class="tooltip">UPPER_CUTOFF<div class="right"><b>compulsory keyword </b>
only pairs of atoms closer than UPPER_CUTOFF are considered in the calculation. <i></i></div></div>=0.8 <span style="display:none;" id="eg9drmsd"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># average of RMSD and DRMSD</span>
<b name="eg9ave" onclick='showPath("eg9","eg9ave")'>ave: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg9rmsd">rmsd</b>,<b name="eg9drmsd">drmsd</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg9ave"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># minimum distance between RMSD and DRMSD</span>
<b name="eg9min" onclick='showPath("eg9","eg9min")'>min: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg9rmsd">rmsd</b>,<b name="eg9drmsd">drmsd</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg9min"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># print all 4 CVs to file every step</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg9"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>Once your <code>plumed.dat</code> file is complete, you can use it with the following command </p><pre class="fragment">&gt; plumed driver --plumed plumed.dat --mf_xtc traj-broken.xtc
</pre><p>and then check that the custom CVs are indeed what they are expected by plotting the <code>COLVAR</code> file with <code>matplotlib</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
