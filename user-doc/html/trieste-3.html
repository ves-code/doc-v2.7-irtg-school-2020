<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: Trieste tutorial: Using restraints</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7b</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('trieste-3.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Trieste tutorial: Using restraints </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="trieste-3-aims"></a>
Aims</h1>
<p>The aim of this tutorial is to introduce the users to the use of constant biases in PLUMED.</p>
<h1><a class="anchor" id="trieste-3-objectives"></a>
Objectives</h1>
<ul>
<li>Apply a restraint on a simulations over one or more collective variables</li>
<li>Understand the effect of a restraint on the acquired statistics</li>
<li>Perform a simple un-biasing of a restrained simulation</li>
<li>Add an external potential in the form of an analytical or numerical function</li>
</ul>
<h1><a class="anchor" id="trieste-3-resources"></a>
Resources</h1>
<p>The <span style="background-color:yellow"><a href="tutorial-resources/trieste-3.tar.gz" style="font-weight:bold" style="color:green" download="trieste-3.tar.gz">TARBALL</a> </span> for this tutorial contains the following files:</p><ul>
<li>wdimer.pdb: a PDB file for two molecules of water in vacuo</li>
<li>wdimer.tpr: a GROMACS run file to perform MD of two water molecules</li>
<li>diala.pdb: a PDB file for alanine dipeptide in vacuo</li>
<li>diala.tpr: a GROMACS run file to perform MD of alanine dipeptide</li>
<li>do_block_histo.py: the python script from <a class="el" href="trieste-2.html">Trieste tutorial: Averaging, histograms and block analysis</a> to perform block averaging over histograms</li>
</ul>
<p>This tutorial has been tested on a pre-release version of version 2.4. However, it should not take advantage of 2.4-only features, thus should also work with version 2.3.</p>
<h1><a class="anchor" id="trieste-3-intro"></a>
Introduction</h1>
<p>PLUMED can calculate conformational properties of a system a posteriori as well as on-the-fly. This information can be use to manipulate a simulation on-the-fly. This means adding energy terms in addition to those of the original Hamiltonian. This additional energy terms are usually referred as <a class="el" href="_bias.html">Bias</a>. In the following we will see how to apply a constant bias potential with PLUMED. It is preferable to run each exercise in a separate folder.</p>
<p> <details> <summary> <b> To learn more: Summary of theory </b> </summary> <div class="hidden">  </p>
<h2><a class="anchor" id="trieste-3-theory-biased-sampling"></a>
Biased sampling</h2>
<p>A system at temperature \( T\) samples conformations from the canonical ensemble: </p><p class="formulaDsp">
\[ P(q)\propto e^{-\frac{U(q)}{k_BT}} \]
</p>
<p>. Here \( q \) are the microscopic coordinates and \( k_B \) is the Boltzmann constant. Since \( q \) is a highly dimensional vector, it is often convenient to analyze it in terms of a few collective variables (see <a class="el" href="trieste-1.html">Trieste tutorial: Analyzing trajectories using PLUMED</a> ). The probability distribution for a CV \( s\) is </p><p class="formulaDsp">
\[ P(s)\propto \int dq e^{-\frac{U(q)}{k_BT}} \delta(s-s(q)) \]
</p>
<p> This probability can be expressed in energy units as a free energy landscape \( F(s) \): </p><p class="formulaDsp">
\[ F(s)=-k_B T \log P(s) \]
</p>
<p>.</p>
<p>Now we would like to modify the potential by adding a term that depends on the CV only. That is, instead of using \( U(q) \), we use \( U(q)+V(s(q))\). There are several reasons why one would like to introduce this potential. One is to avoid that the system samples some un-desired portion of the conformational space. As an example, imagine that you want to study dissociation of a complex of two molecules. If you perform a very long simulation you will be able to see association and dissociation. However, the typical time required for association will depend on the size of the simulation box. It could be thus convenient to limit the exploration to conformations where the distance between the two molecules is lower than a given threshold. This could be done by adding a bias potential on the distance between the two molecules. Another example is the simulation of a portion of a large molecule taken out from its initial context. The fragment alone could be unstable, and one might want to add additional potentials to keep the fragment in place. This could be done by adding a bias potential on some measure of the distance from the experimental structure (e.g. on root-mean-square deviation).</p>
<p>Whatever CV we decide to bias, it is very important to recognize which is the effect of this bias and, if necessary, remove it a posteriori. The biased distribution of the CV will be </p><p class="formulaDsp">
\[ P&#39;(s)\propto \int dq e^{-\frac{U(q)+V(s(q))}{k_BT}} \delta(s-s(q))\propto e^{-\frac{V(s(q))}{k_BT}}P(s) \]
</p>
<p> and the biased free energy landscape </p><p class="formulaDsp">
\[ F&#39;(s)=-k_B T \log P&#39;(s)=F(s)+V(s)+C \]
</p>
<p> Thus, the effect of a bias potential on the free energy is additive. Also notice the presence of an undetermined constant \( C \). This constant is irrelevant for what concerns free-energy differences and barriers, but will be important later when we will learn the weighted-histogram method. Obviously the last equation can be inverted so as to obtain the original, unbiased free-energy landscape from the biased one just subtracting the bias potential </p><p class="formulaDsp">
\[ F(s)=F&#39;(s)-V(s)+C \]
</p>
<p>Additionally, one might be interested in recovering the distribution of an arbitrary observable. E.g., one could add a bias on the distance between two molecules and be willing to compute the unbiased distribution of some torsional angle. In this case there is no straightforward relationship that can be used, and one has to go back to the relationship between the microscopic probabilities: </p><p class="formulaDsp">
\[ P(q)\propto P&#39;(q) e^{\frac{V(s(q))}{k_BT}} \]
</p>
<p> The consequence of this expression is that one can obtained any kind of unbiased information from a biased simulation just by weighting every sampled conformation with a weight </p><p class="formulaDsp">
\[ w\propto e^{\frac{V(s(q))}{k_BT}} \]
</p>
<p> That is, frames that have been explored in spite of a high (disfavoring) bias potential \( V \) will be counted more than frames that has been explored with a less disfavoring bias potential.</p>
<p> </div> </details> </p>
<p>We will make use of two toy models: the first is a water dimer, i.e. two molecules of water in vacuo, that we will use to compare the effect of a constant bias on the equilibrium properties of the system that in this case can be readily computed. The second toy model is alanine dipeptide in vacuo. This system is more challenging to characterize with a standard MD simulation and we will see how we can use an interactive approach to to build a constant bias that will help in flattening the underlying free energy surface and thus sped up the sampling.</p>
<dl class="section note"><dt>Note</dt><dd>Create a folder for each exercise and use sub-folders if you want to run the same simulation with multiple choices for the parameters</dd></dl>
<h1><a class="anchor" id="trieste-3-ex-1"></a>
Exercise 1: converged histogram of the water dimer relative distance</h1>
<div class="image">
<img src="trieste-3-wdimer.png" alt=""/>
<div class="caption">
A water dimer</div></div>
<p>First of all let's start to learn something about the water dimer system by running a first simulations. You can start by creating a folder with the dimer.tpr file and run a simulation.</p>
<pre class="fragment">&gt; gmx mdrun -s dimer.tpr  
</pre><p>In this way we have a 25ns long trajectory that we can use to have a first look at the behavior of the system. Is the sampling of the relative distance between the two water molecules converged?</p>
<p>Use plumed driver to analyze the trajectory and evaluate the quality of the sampling.</p>
<p>Here you can find a sample <code>plumed.dat</code> file that you can use as a template. Whenever you see an highlighted <span style="background-color:yellow">FILL</span> string, this is a string that you should replace.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># vim:ft=plumed</span>
<span style="color:blue">#compute the distance between the two oxygens</span>
<b name="eg1d" onclick='showPath("eg1","eg1d")'>d: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,4 <span style="display:none;" id="eg1d">The DISTANCE action with label <b>d</b> calculates a single scalar value</span>
<span style="color:blue">#accumulate block histograms</span>
<b name="eg1hh" onclick='showPath("eg1","eg1hh")'>hh: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg1d">d</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=10 <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=0 <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=4.0 <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=200 <div class="tooltip">KERNEL<div class="right"><b>compulsory keyword ( default=gaussian )</b>
the kernel function you are using. <i></i></div></div>=DISCRETE <div class="tooltip">CLEAR<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which to clear all the accumulated data. <i></i></div></div>=10000 <span style="display:none;" id="eg1hh">The HISTOGRAM action with label <b>hh</b></span>
<span style="color:blue">#and dump them</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the grid you would like to output <i></i></div></div>=<b name="eg1hh">hh</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=density )</b>
the file on which to write the grid. <i></i></div></div>=my_histogram.dat <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which the grid should be output to the file. <i></i></div></div>=10000 <span style="display:none;" id="eg1">The DUMPGRID action with label <b></b></span>
<span style="color:blue"># Print the collective variable.</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg1d">d</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=10 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=distance.dat <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<pre class="fragment">&gt; plumed driver --mf_xtc traj_comp.xtc --plumed plumed.dat  
&gt; python3 do_block_histo.py &gt; final-histo-10000.dat
</pre><p>If there is something you don't remember about this procedure go back and check in <a class="el" href="trieste-2.html">Trieste tutorial: Averaging, histograms and block analysis</a> . There you can also find a python script to perform block averaging of the histograms and assess the error. The result should be comparable with the following: </p><div class="image">
<img src="trieste-3-histo-dimer.png" alt=""/>
<div class="caption">
A histogram of the relative distance (in nm) with errors</div></div>
<p> Notice the peak at 0.9 nm, this is the effect of using cut-off for the calculation of the interactions in the simulation (check the run-dimer.mdp file for the properties of the run)</p>
<h1><a class="anchor" id="trieste-3-ex-2"></a>
Exercise 2: Apply a linear restraint on the same collective variable</h1>
<p>Now we will try to apply a linear restraint on the relative distance and compare the resulting distribution. The new sampling will reflect the effect of the bias. Be careful about the statistics: in the simulation of exercise 1 you were post processing a trajectory of 125000 frames accumulating one frame every ten in an histogram and clearing the histogram after 10000 steps. As a result you had 12 blocks in the form of 11 analysis.* files and a final block named my_histogram.dat. In the following try to accumulate on the fly the same amount of statistics. Look into the .mdp file to see how often frames are written in a trajectory. If you write too many analysis.* files (i.e. 100 files plumed will fail with an error).</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># vim:ft=plumed</span>
<span style="color:blue">#compute the distance between the two oxygens</span>
<b name="eg2d" onclick='showPath("eg2","eg2d")'>d: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <span style="background-color:yellow">__FILL__</span><span style="display:none;" id="eg2d"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#accumulate block histograms</span>
<b name="eg2hh" onclick='showPath("eg2","eg2hh")'>hh: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2d">d</b> <div class="tooltip">KERNEL<div class="right"><b>compulsory keyword ( default=gaussian )</b>
the kernel function you are using. <i></i></div></div>=DISCRETE <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=500 <div class="tooltip">CLEAR<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which to clear all the accumulated data. <i></i></div></div>=500000 <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=0 <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=4.0 <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=200 <span style="display:none;" id="eg2hh"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#and dump them</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <span style="background-color:yellow">__FILL__</span><span style="display:none;" id="eg2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#apply a linear restraint</span>
<b name="eg2lr" onclick='showPath("eg2","eg2lr")'>lr: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_r_e_s_t_r_a_i_n_t.html" style="color:green">RESTRAINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2d">d</b> <div class="tooltip">KAPPA<div class="right"><b>compulsory keyword ( default=0.0 )</b>
specifies that the restraint is harmonic and what the values of the force constants
on each of the variables are <i></i></div></div>=0 <div class="tooltip">AT<div class="right"><b>compulsory keyword </b>
the position of the restraint <i></i></div></div>=0 <div class="tooltip">SLOPE<div class="right"><b>compulsory keyword ( default=0.0 )</b>
specifies that the restraint is linear and what the values of the force constants
on each of the variables are <i></i></div></div>=2.5 <span style="display:none;" id="eg2lr"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># Print the collective variable and the bias.</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <span style="background-color:yellow">__FILL__</span><span style="display:none;" id="eg2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>In a new folder we can run this new simulation this time biasing and analyzing the simulation on-the-fly.</p>
<pre class="fragment">&gt; gmx mdrun -s dimer.tpr -plumed plumed.dat 
</pre><p>The histogram should look different.</p>
<p>The effect of a constant bias is that of systematically changing the probability of each conformation by a factor \( \exp(+V_{bias}/k_{B}T) \). This means that it is easily possible to recover the un-biased distribution at least in the regions of the conformational space that have been thoroughly sampled. In practice the statistical weight of each frame is not 1 anymore but is given by the exponential of the bias.</p>
<p>In order to recover the unbiased distribution we can post process the simulation using plumed driver to recalculate the bias felt by each frame and store this information to analyze any property. Furthermore plumed can also automatically use the bias to reweight the accumulated histogram.</p>

<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># vim:ft=plumed</span>
<b name="eg3d" onclick='showPath("eg3","eg3d")'>d: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <span style="background-color:yellow">__FILL__</span><span style="display:none;" id="eg3d"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg3lr" onclick='showPath("eg3","eg3lr")'>lr: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_r_e_s_t_r_a_i_n_t.html" style="color:green">RESTRAINT</a> <span style="background-color:yellow">__FILL__</span><span style="display:none;" id="eg3lr"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg3as" onclick='showPath("eg3","eg3as")'>as: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=298 <span style="display:none;" id="eg3as"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> ...
   <div class="tooltip">LOGWEIGHTS<div class="right">list of actions that calculates log weights that should be used to weight configurations
when calculating averages <i></i></div></div>=<b name="eg3as">as</b> 
   <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg3d">d</b> 
   <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=10 
   <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=0 <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=4.0 <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=200 
   <div class="tooltip">KERNEL<div class="right"><b>compulsory keyword ( default=gaussian )</b>
the kernel function you are using. <i></i></div></div>=DISCRETE 
   <div class="tooltip">CLEAR<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which to clear all the accumulated data. <i></i></div></div>=10000 
...<span style="display:none;" id="eg3"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <span style="background-color:yellow">__FILL__</span><span style="display:none;" id="eg3"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=*.* <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <span style="display:none;" id="eg3"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>Be careful again about the difference in the way statistics is accumulated on-the-fly or for post processing. This is not critical for the result but is important in order to have comparable histograms, that is histograms with comparable noise. Remember to give different names to the new histogram otherwise the one obtained before will be overwritten.</p>
<pre class="fragment">&gt; plumed driver --mf_xtc traj_comp.xtc --plumed plumed.dat  
</pre><dl class="section note"><dt>Note</dt><dd>To run block analysis of both sets of histograms you need to edit the python script because the file name is hard coded.</dd></dl>
<pre class="fragment">&gt; python3 do_block_histo.py &gt; histo-biased.dat 
&gt; python3 do_block_histo.py &gt; histo-reweighted.dat 
</pre><p>Now the resulting histogram should be comparable to the reference one.</p>
<h1><a class="anchor" id="trieste-3-ex-3"></a>
Exercise 3: Apply a quadratic restraint on the same collective variable</h1>
<p>Do you expect a different behavior? This time we can write the plumed input file in such a way to compare directly the biased and unbiased histograms.</p>

<div style="width: 90%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># vim:ft=plumed</span>
<span style="color:blue">#calculate the distance</span>
<b name="eg4d" onclick='showPath("eg4","eg4d")'>d: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,4 <span style="display:none;" id="eg4d">The DISTANCE action with label <b>d</b> calculates a single scalar value</span>
<span style="color:blue">#apply the quadratic restraint centered at a distance of 0.5 nm</span>
<b name="eg4lr" onclick='showPath("eg4","eg4lr")'>lr: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_r_e_s_t_r_a_i_n_t.html" style="color:green">RESTRAINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg4d">d</b> <div class="tooltip">KAPPA<div class="right"><b>compulsory keyword ( default=0.0 )</b>
specifies that the restraint is harmonic and what the values of the force constants
on each of the variables are <i></i></div></div>=10 <div class="tooltip">AT<div class="right"><b>compulsory keyword </b>
the position of the restraint <i></i></div></div>=0.5 <span style="display:none;" id="eg4lr">The RESTRAINT action with label <b>lr</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">lr.bias</td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%%">lr.force2</td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table>
</span>
<span style="color:blue">#accumulate the biased histogram</span>
<b name="eg4hh" onclick='showPath("eg4","eg4hh")'>hh: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg4d">d</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=500 <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=0 <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=4.0 <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=200 <div class="tooltip">KERNEL<div class="right"><b>compulsory keyword ( default=gaussian )</b>
the kernel function you are using. <i></i></div></div>=DISCRETE <div class="tooltip">CLEAR<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which to clear all the accumulated data. <i></i></div></div>=500000 <span style="display:none;" id="eg4hh">The HISTOGRAM action with label <b>hh</b></span>
<span style="color:blue">#dumpit</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the grid you would like to output <i></i></div></div>=<b name="eg4hh">hh</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=density )</b>
the file on which to write the grid. <i></i></div></div>=my_histogram.dat <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which the grid should be output to the file. <i></i></div></div>=500000 <span style="display:none;" id="eg4">The DUMPGRID action with label <b></b></span>
<span style="color:blue">#calculate the weights from the constant bias</span>
<b name="eg4as" onclick='showPath("eg4","eg4as")'>as: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=298 <span style="display:none;" id="eg4as">The REWEIGHT_BIAS action with label <b>as</b> calculates a single scalar value</span>
<span style="color:blue">#accumulate the unbiased histogram</span>
<b name="eg4hhu" onclick='showPath("eg4","eg4hhu")'>hhu: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg4d">d</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=500 <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=0 <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=4.0 <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=200 <div class="tooltip">KERNEL<div class="right"><b>compulsory keyword ( default=gaussian )</b>
the kernel function you are using. <i></i></div></div>=DISCRETE <div class="tooltip">CLEAR<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which to clear all the accumulated data. <i></i></div></div>=500000 <div class="tooltip">LOGWEIGHTS<div class="right">list of actions that calculates log weights that should be used to weight configurations
when calculating averages <i></i></div></div>=<b name="eg4as">as</b> <span style="display:none;" id="eg4hhu">The HISTOGRAM action with label <b>hhu</b></span>
<span style="color:blue">#dumpit</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the grid you would like to output <i></i></div></div>=<b name="eg4hhu">hhu</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=density )</b>
the file on which to write the grid. <i></i></div></div>=myhistu.dat <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which the grid should be output to the file. <i></i></div></div>=500000 <span style="display:none;" id="eg4">The DUMPGRID action with label <b></b></span>
<span style="color:blue">#print distance and bias</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg4d">d</b>,<b name="eg4lr">lr.bias</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=distance.dat <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=50 <span style="display:none;" id="eg4">The PRINT action with label <b></b></span>
</pre>
<p>The comparison of the two histograms with the former will show the effect of the weak quadratic bias on the simulation.</p>
<dl class="section note"><dt>Note</dt><dd>To run block analysis of both sets of histograms you need to edit the python script because the file name is hard coded.</dd></dl>
<pre class="fragment">&gt; python3 do_block_histo.py &gt; histo-biased.dat 
&gt; python3 do_block_histo.py &gt; histo-reweighted.dat 
</pre><h1><a class="anchor" id="trieste-3-ex-4"></a>
Exercise 4: Apply an upper wall on the distance.</h1>
<p>In the above cases we have always applied weak biases. Sometimes biases are useful to prevent the system in reaching some region of the conformational space. In this case instead of using <a class="el" href="_r_e_s_t_r_a_i_n_t.html">RESTRAINT</a> , we can make use of lower or upper restraints, e.g. <a class="el" href="_l_o_w_e_r__w_a_l_l_s.html">LOWER_WALLS</a> and <a class="el" href="_u_p_p_e_r__w_a_l_l_s.html">UPPER_WALLS</a>.</p>
<p>What happen to the histogram when we use walls?</p>

<div style="width: 90%; float:left" id="value_details_eg5"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># vim:ft=plumed</span>
<b name="eg5d" onclick='showPath("eg5","eg5d")'>d: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,4 <span style="display:none;" id="eg5d"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg5uw" onclick='showPath("eg5","eg5uw")'>uw: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_u_p_p_e_r__w_a_l_l_s.html" style="color:green">UPPER_WALLS</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg5d">d</b> <div class="tooltip">KAPPA<div class="right"><b>compulsory keyword </b>
the force constant for the wall. <i></i></div></div>=1000 <div class="tooltip">AT<div class="right"><b>compulsory keyword </b>
the positions of the wall. <i></i></div></div>=2.5 <span style="display:none;" id="eg5uw"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># accumulate the biased histogram</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg5"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#dumpit</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg5"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># calculate the weights from the constant bias</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg5"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#accumulate the unbiased histogram</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg5"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#dumpit</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg5"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#print distance and bias</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg5"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>Run it.</p>
<pre class="fragment">&gt; gmx mdrun -s dimer.tpr -plumed plumed.dat 
</pre><p>If we have not sampled a region thoroughly enough it is not possible to estimate the histogram in that region even using reweighting (reweighting is not magic!).</p>
<h1><a class="anchor" id="trieste-3-ex-5"></a>
Exercise 5: Evaluate the free energy and use it as an external restraint</h1>
<p>The main issue in sampling rare events is that importance sampling algorithms spend more time in low energy regions and if two low energy regions are separated by a high energy one is unlikely for the sampling algorithm to cross the high energy region and reach the other low energy one. From this point of view an algorithm based on random sampling will work better in crossing the barrier. A particularly efficient sampling can be obtained if one would know the underlying free energy and thus use that to bias the sampling and make the sampling probability uniform in the regions of relevant interest. In this exercise we will make use of the free-energy estimate along the distance collective variable to bias the sampling of the same collective variable in the dimer simulation. To do so we will make use of a table potential applied using the <a class="el" href="_bias.html">Bias</a> <a class="el" href="_e_x_t_e_r_n_a_l.html">EXTERNAL</a>. We first need to get a smooth estimate of the free-energy from our fist reference simulations, we will do this by accumulating a histogram with kernel functions, that is continuous function centered at the value of the accumulated point and added accumulated on the discrete representation of the histogram, see <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">Kernel density estimation </a>.</p>

<div style="width: 90%; float:left" id="value_details_eg6"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># vim:ft=plumed</span>
<span style="color:blue">#calculate the distance</span>
<b name="eg6d" onclick='showPath("eg6","eg6d")'>d: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,4 <span style="display:none;" id="eg6d"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#accumulate the histogram using a gaussian kernel with 0.05 nm width</span>
<b name="eg6hh2" onclick='showPath("eg6","eg6hh2")'>hh2: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg6d">d</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=10 <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=0 <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=4.0 <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=400 <div class="tooltip">BANDWIDTH<div class="right"><b>compulsory keyword </b>
the bandwidths for kernel density estimation <i></i></div></div>=0.05 <span style="display:none;" id="eg6hh2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#convert to a free energy</span>
<b name="eg6ff" onclick='showPath("eg6","eg6ff")'>ff: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_o_n_v_e_r_t__t_o__f_e_s.html" style="color:green">CONVERT_TO_FES</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the input grid you would like to use <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">TEMP<div class="right">the temperature at which you are operating <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg6ff"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#dump the free energy</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the grid you would like to output <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=density )</b>
the file on which to write the grid. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg6"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>by running plumed driver on the reference trajectory we obtain a free energy estimate.</p>
<pre class="fragment">&gt; plumed driver --mf_xtc traj_comp.xtc --plumed plumed.dat  
</pre><p>The resulting file for the free energy should be edited in order to:</p><ul>
<li>Invert the sign of the free-energy and of its derivative</li>
<li>Remove some unused flag and regions with infinite potential at the boundaries</li>
</ul>
<p>The file looks like:</p>
<pre class="fragment">#! FIELDS d ff dff_d
#! SET min_d 0
#! SET max_d 4.0
#! SET nbins_d  400
#! SET periodic_d false
0.060000 -34.9754 185.606
0.070000 -26.0117 184.362
0.080000 -20.8195 181.39
0.090000 -17.5773 176.718
</pre><p>where the first column is the grid spacing, the second the free energy and the third the derivative of the free energy. You can edit the file as you want, for example using the following bash lines:</p>
<pre class="fragment">grep \# ff.dat | grep -v normalisation &gt; external.dat
grep -v \# ff.dat | awk '{print $1, -$2, -$3}' | grep -v inf &gt;&gt; external.dat 
</pre><p>Furthermore edit the first line of external.dat from</p>
<pre class="fragment">#! FIELDS d ff dff_d
</pre><p>to</p>
<pre class="fragment">#! FIELDS d ff.bias der_d
</pre><p>Now we have an external potential that is the opposite of the free energy and we can use it in a new folder to bias a simulation:</p>

<div style="width: 90%; float:left" id="value_details_eg7"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># vim:ft=plumed</span>
<b name="eg7d" onclick='showPath("eg7","eg7d")'>d: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,4 <span style="display:none;" id="eg7d"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg7ff" onclick='showPath("eg7","eg7ff")'>ff: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_e_x_t_e_r_n_a_l.html" style="color:green">EXTERNAL</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg7d">d</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file containing the external potential. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg7ff"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># accumulate the biased histogram</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg7"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#dumpit</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg7"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># calculate the weights from the constant bias</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg7"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#accumulate the unbiased histogram</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg7"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#dumpit</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg7"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue">#print distance and bias</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg7"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>Run it.</p>
<pre class="fragment">&gt; gmx mdrun -s dimer.tpr -plumed plumed.dat 
</pre><p>How do the biased and unbiased histograms look like? In the following we will apply this concept to sample the conformational space of a more complex system.</p>
<h1><a class="anchor" id="trieste-3-ex-6"></a>
Exercise 6: Preliminary run with Alanine dipeptide</h1>
<p>Alanine dipeptide is characterized by multiple minima separated by relatively high free energy barriers. Here we will explore the conformational space of alanine dipeptide using a standard MD simulation, then instead of using the free energy as an external potential we will try to fit the potential using gnuplot and add a bias using an analytical function of a collective variable with <a class="el" href="_m_a_t_h_e_v_a_l.html">MATHEVAL</a> and <a class="el" href="_b_i_a_s_v_a_l_u_e.html">BIASVALUE</a> .</p>
<p>As a first test lets run an MD and generate on-the-fly the free energy as a function of the phi and psi collective variables separately.</p>

<div style="width: 90%; float:left" id="value_details_eg8"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue">#SETTINGS MOLFILE=user-doc/tutorials/old_tutorials/trieste-3/aladip/aladip.pdb</span>
<span style="color:blue"># vim:ft=plumed</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> <div class="tooltip">STRUCTURE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing a reference structure. <i></i></div></div>=aladip.pdb <span style="display:none;" id="eg8">The MOLINFO action with label <b></b></span>
<b name="eg8phi" onclick='showPath("eg8","eg8phi")'>phi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-2 <span style="display:none;" id="eg8phi">The TORSION action with label <b>phi</b> calculates a single scalar value</span>
<b name="eg8psi" onclick='showPath("eg8","eg8psi")'>psi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-2 <span style="display:none;" id="eg8psi">The TORSION action with label <b>psi</b> calculates a single scalar value</span>
<b name="eg8hhphi" onclick='showPath("eg8","eg8hhphi")'>hhphi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg8phi">phi</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=10 <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=-pi <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=pi <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=600 <div class="tooltip">BANDWIDTH<div class="right"><b>compulsory keyword </b>
the bandwidths for kernel density estimation <i></i></div></div>=0.05 <span style="display:none;" id="eg8hhphi">The HISTOGRAM action with label <b>hhphi</b></span>
<b name="eg8hhpsi" onclick='showPath("eg8","eg8hhpsi")'>hhpsi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg8psi">psi</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=10 <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=-pi <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=pi <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=600 <div class="tooltip">BANDWIDTH<div class="right"><b>compulsory keyword </b>
the bandwidths for kernel density estimation <i></i></div></div>=0.05 <span style="display:none;" id="eg8hhpsi">The HISTOGRAM action with label <b>hhpsi</b></span>
<b name="eg8ffphi" onclick='showPath("eg8","eg8ffphi")'>ffphi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_o_n_v_e_r_t__t_o__f_e_s.html" style="color:green">CONVERT_TO_FES</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the input grid you would like to use <i></i></div></div>=<b name="eg8hhphi">hhphi</b> <div class="tooltip">TEMP<div class="right">the temperature at which you are operating <i></i></div></div>=298 <span style="display:none;" id="eg8ffphi">The CONVERT_TO_FES action with label <b>ffphi</b></span>
<b name="eg8ffpsi" onclick='showPath("eg8","eg8ffpsi")'>ffpsi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_o_n_v_e_r_t__t_o__f_e_s.html" style="color:green">CONVERT_TO_FES</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the input grid you would like to use <i></i></div></div>=<b name="eg8hhpsi">hhpsi</b> <div class="tooltip">TEMP<div class="right">the temperature at which you are operating <i></i></div></div>=298 <span style="display:none;" id="eg8ffpsi">The CONVERT_TO_FES action with label <b>ffpsi</b></span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the grid you would like to output <i></i></div></div>=<b name="eg8ffphi">ffphi</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=density )</b>
the file on which to write the grid. <i></i></div></div>=<b name="eg8ffphi">ffphi.dat</b> <span style="display:none;" id="eg8">The DUMPGRID action with label <b></b></span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the grid you would like to output <i></i></div></div>=<b name="eg8ffpsi">ffpsi</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=density )</b>
the file on which to write the grid. <i></i></div></div>=<b name="eg8ffpsi">ffpsi.dat</b> <span style="display:none;" id="eg8">The DUMPGRID action with label <b></b></span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg8phi">phi</b>,<b name="eg8psi">psi</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar.dat <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=10 <span style="display:none;" id="eg8">The PRINT action with label <b></b></span>
</pre>
<p>from the colvar file it is clear that we can quickly explore two minima but that the region for positive phi is not accessible. Instead of using the opposite of the free energy as a table potential here we introduce the function <a class="el" href="_m_a_t_h_e_v_a_l.html">MATHEVAL</a> that allows defining complex analytical functions of collective variables, and the bias <a class="el" href="_b_i_a_s_v_a_l_u_e.html">BIASVALUE</a> that allows using any continuous function of the positions as a bias.</p>
<p>So first we need to fit the opposite of the free energy as a function of phi in the region explored with a periodic function, because of the gaussian like look of the minima we can fit it using <a href="https://en.wikipedia.org/wiki/Von_Mises_distribution">the von Mises distribution</a>. In gnuplot</p>
<pre class="fragment">&gt;gnuplot
gnuplot&gt;plot 'ffphi.dat' u 1:(-$2+31) w l
gnuplot&gt;f(x)=exp(k1*cos(x-a1))+exp(k2*cos(x-a2))
gnuplot&gt;fit [-3.:-0.6] f(x) 'ffphi.dat' u 1:(-$2+31) via k1,a1,k2,a2
gnuplot&gt;rep f(x)
</pre><p>The function and the resulting parameters can be used to run a new biased simulation:</p>
<h1><a class="anchor" id="trieste-3-ex-7"></a>
Exercise 7: First biased run with Alanine dipeptide</h1>

<div style="width: 90%; float:left" id="value_details_eg9"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue">#SETTINGS MOLFILE=user-doc/tutorials/trieste-3/aladip/aladip.pdb</span>
<span style="color:blue"># vim:ft=plumed</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> <div class="tooltip">STRUCTURE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing a reference structure. <i></i></div></div>=aladip.pdb <span style="display:none;" id="eg9"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg9phi" onclick='showPath("eg9","eg9phi")'>phi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-2 <span style="display:none;" id="eg9phi"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg9"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg9doubleg" onclick='showPath("eg9","eg9doubleg")'>doubleg: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_a_t_h_e_v_a_l.html" style="color:green">MATHEVAL</a> ...
   <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg9phi">phi</b> 
   
   <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=exp(__FILL)+__FILL__ 
   <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO 
...<span style="display:none;" id="eg9doubleg"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg9b" onclick='showPath("eg9","eg9b")'>b: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_b_i_a_s_v_a_l_u_e.html" style="color:green">BIASVALUE</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg9b"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <span style="background-color:yellow">__FILL__</span><span style="display:none;" id="eg9"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>It is now possible to run a second simulation and observe the new behavior. The system quickly explores a new minimum. While a quantitative estimate of the free energy difference of the old and new regions is out of the scope of the current exercise what we can do is to add a new von Mises function centered in the new minimum with a comparable height, in this way we can hope to facilitate a back and forth transition along the phi collective variable.</p>
<pre class="fragment">&gt;gnuplot
gnuplot&gt; ...
</pre><p>We can now run a third simulation where both regions are biased.</p>
<h1><a class="anchor" id="trieste-3-ex-8"></a>
Exercise 8: Second biased run with Alanine dipeptide</h1>

<div style="width: 90%; float:left" id="value_details_eg10"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue">#SETTINGS MOLFILE=user-doc/tutorials/trieste-3/aladip/aladip.pdb</span>
<span style="color:blue"># vim:ft=plumed</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> <div class="tooltip">STRUCTURE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing a reference structure. <i></i></div></div>=aladip.pdb <span style="display:none;" id="eg10"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg10phi" onclick='showPath("eg10","eg10phi")'>phi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-2 <span style="display:none;" id="eg10phi"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg10psi" onclick='showPath("eg10","eg10psi")'>psi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-2 <span style="display:none;" id="eg10psi"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg10tripleg" onclick='showPath("eg10","eg10tripleg")'>tripleg: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_a_t_h_e_v_a_l.html" style="color:green">MATHEVAL</a> ...
   <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg10phi">phi</b> 
   
   <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=exp(k1*cos(x-a1))+exp(k2*cos(x-a2))+exp(k3*cos(x+a3)) 
   <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO 
...<span style="display:none;" id="eg10tripleg"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg10b" onclick='showPath("eg10","eg10b")'>b: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_b_i_a_s_v_a_l_u_e.html" style="color:green">BIASVALUE</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg10tripleg">tripleg</b> <span style="display:none;" id="eg10b"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/___f_i_l_l__.html" style="color:green">__FILL__</a> <span style="display:none;" id="eg10"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_e_n_d_p_l_u_m_e_d.html" style="color:green">ENDPLUMED</a> <span style="display:none;" id="eg10"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>With this third simulation it should be possible to visit both regions as a function on the phi torsion. Now it is possible to reweight the sampling and obtain a better free energy estimate along phi.</p>

<div style="width: 90%; float:left" id="value_details_eg11"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue">#SETTINGS MOLFILE=user-doc/tutorials/trieste-3/aladip/aladip.pdb</span>
<span style="color:blue"># vim:ft=plumed</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> <div class="tooltip">STRUCTURE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing a reference structure. <i></i></div></div>=aladip.pdb <span style="display:none;" id="eg11"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg11phi" onclick='showPath("eg11","eg11phi")'>phi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-2 <span style="display:none;" id="eg11phi"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg11psi" onclick='showPath("eg11","eg11psi")'>psi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-2 <span style="display:none;" id="eg11psi"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg11tripleg" onclick='showPath("eg11","eg11tripleg")'>tripleg: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_a_t_h_e_v_a_l.html" style="color:green">MATHEVAL</a> ...
   <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg11phi">phi</b> 
   
   <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> 
   <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO 
...<span style="display:none;" id="eg11tripleg"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg11b" onclick='showPath("eg11","eg11b")'>b: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_b_i_a_s_v_a_l_u_e.html" style="color:green">BIASVALUE</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg11tripleg">tripleg</b> <span style="display:none;" id="eg11b"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg11as" onclick='showPath("eg11","eg11as")'>as: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=298 <span style="display:none;" id="eg11as"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg11hhphi" onclick='showPath("eg11","eg11hhphi")'>hhphi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg11phi">phi</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=10 <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=-pi <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=pi <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=600 <div class="tooltip">BANDWIDTH<div class="right"><b>compulsory keyword </b>
the bandwidths for kernel density estimation <i></i></div></div>=0.05 <div class="tooltip">LOGWEIGHTS<div class="right">list of actions that calculates log weights that should be used to weight configurations
when calculating averages <i></i></div></div>=<b name="eg11as">as</b> <span style="display:none;" id="eg11hhphi"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg11hhpsi" onclick='showPath("eg11","eg11hhpsi")'>hhpsi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg11psi">psi</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=10 <div class="tooltip">GRID_MIN<div class="right"><b>compulsory keyword </b>
the lower bounds for the grid <i></i></div></div>=-pi <div class="tooltip">GRID_MAX<div class="right"><b>compulsory keyword </b>
the upper bounds for the grid <i></i></div></div>=pi <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=600 <div class="tooltip">BANDWIDTH<div class="right"><b>compulsory keyword </b>
the bandwidths for kernel density estimation <i></i></div></div>=0.05 <div class="tooltip">LOGWEIGHTS<div class="right">list of actions that calculates log weights that should be used to weight configurations
when calculating averages <i></i></div></div>=<b name="eg11as">as</b> <span style="display:none;" id="eg11hhpsi"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg11ffphi" onclick='showPath("eg11","eg11ffphi")'>ffphi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_o_n_v_e_r_t__t_o__f_e_s.html" style="color:green">CONVERT_TO_FES</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the input grid you would like to use <i></i></div></div>=<b name="eg11hhphi">hhphi</b> <div class="tooltip">TEMP<div class="right">the temperature at which you are operating <i></i></div></div>=298 <span style="display:none;" id="eg11ffphi"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg11ffpsi" onclick='showPath("eg11","eg11ffpsi")'>ffpsi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_o_n_v_e_r_t__t_o__f_e_s.html" style="color:green">CONVERT_TO_FES</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the input grid you would like to use <i></i></div></div>=<b name="eg11hhpsi">hhpsi</b> <div class="tooltip">TEMP<div class="right">the temperature at which you are operating <i></i></div></div>=298 <span style="display:none;" id="eg11ffpsi"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the grid you would like to output <i></i></div></div>=<b name="eg11ffphi">ffphi</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=density )</b>
the file on which to write the grid. <i></i></div></div>=<b name="eg11ffphi">ffphi.dat</b> <span style="display:none;" id="eg11"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the grid you would like to output <i></i></div></div>=<b name="eg11ffpsi">ffpsi</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=density )</b>
the file on which to write the grid. <i></i></div></div>=<b name="eg11ffpsi">ffpsi.dat</b> <span style="display:none;" id="eg11"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg11phi">phi</b>,<b name="eg11psi">psi</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar.dat <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=10 <span style="display:none;" id="eg11"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>If you have time you can extend this in two-dimensions using at the same time the phi and psi collective variables. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li><li class="navelem"><a class="el" href="oldtutorials.html">Old Tutorials</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
