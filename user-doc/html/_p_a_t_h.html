<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: PATH</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7b</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_p_a_t_h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PATH </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the mapping <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Path collective variables with a more flexible framework for the distance metric being used.</p>
<p>The Path Collective Variables developed by Branduardi and co-workers <a class="el" href="citelist.html#CITEREF_brand07">[23]</a> allow one to compute the progress along a high-dimensional path and the distance from the high-dimensional path. The progress along the path (s) is computed using:</p>
<p class="formulaDsp">
\[ s = \frac{ \sum_{i=1}^N i \exp( -\lambda R[X - X_i] ) }{ \sum_{i=1}^N \exp( -\lambda R[X - X_i] ) } \]
</p>
<p>while the distance from the path (z) is measured using:</p>
<p class="formulaDsp">
\[ z = -\frac{1}{\lambda} \ln\left[ \sum_{i=1}^N \exp( -\lambda R[X - X_i] ) \right] \]
</p>
<p>In these expressions \(N\) high-dimensional frames ( \(X_i\)) are used to describe the path in the high-dimensional space. The two expressions above are then functions of the distances from each of the high-dimensional frames \(R[X - X_i]\). Within PLUMED there are multiple ways to define the distance from a high-dimensional configuration. You could calculate the RMSD distance or you could calculate the amount by which a set of collective variables change. As such this implementation of the path CV allows one to use all the difference distance metrics that are discussed in <a class="el" href="dists.html">Distances from reference configurations</a>. This is as opposed to the alternative implementation of path (<a class="el" href="_p_a_t_h_m_s_d.html">PATHMSD</a>) which is a bit faster but which only allows one to use the RMSD distance.</p>
<p>The \(s\) and \(z\) variables are calculated using the above formulas by default. However, there is an alternative method of calculating these collective variables, which is detailed in <a class="el" href="citelist.html#CITEREF_bernd-path">[44]</a>. This alternative method uses the tools of geometry (as opposed to algebra, which is used in the equations above). In this alternative formula the progress along the path \(s\) is calculated using:</p>
<p class="formulaDsp">
\[ s = i_2 + \textrm{sign}(i_2-i_1) \frac{ \sqrt{( \mathbf{v}_1\cdot\mathbf{v}_2 )^2 - |\mathbf{v}_3|^2(|\mathbf{v}_1|^2 - |\mathbf{v}_2|^2) } }{2|\mathbf{v}_3|^2} - \frac{\mathbf{v}_1\cdot\mathbf{v}_3 - |\mathbf{v}_3|^2}{2|\mathbf{v}_3|^2} \]
</p>
<p>where \(\mathbf{v}_1\) and \(\mathbf{v}_3\) are the vectors connecting the current position to the closest and second closest node of the path, respectfully and \(i_1\) and \(i_2\) are the projections of the closest and second closest frames of the path. \(\mathbf{v}_2\), meanwhile, is the vector connecting the closest frame to the second closest frame. The distance from the path, \(z\) is calculated using:</p>
<p class="formulaDsp">
\[ z = \sqrt{ \left[ |\mathbf{v}_1|^2 - |\mathbf{v}_2| \left( \frac{ \sqrt{( \mathbf{v}_1\cdot\mathbf{v}_2 )^2 - |\mathbf{v}_3|^2(|\mathbf{v}_1|^2 - |\mathbf{v}_2|^2) } }{2|\mathbf{v}_3|^2} - \frac{\mathbf{v}_1\cdot\mathbf{v}_3 - |\mathbf{v}_3|^2}{2|\mathbf{v}_3|^2} \right) \right]^2 } \]
</p>
<p>The symbols here are as they were for \(s\). If you would like to use these equations to calculate \(s\) and \(z\) then you should use the GPATH flag. The values of \(s\) and \(z\) can then be referenced using the gspath and gzpath labels.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In the example below the path is defined using RMSD distance from frames.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1p1" onclick='showPath("eg1","eg1p1")'>p1: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_a_t_h.html" style="color:green">PATH</a> <div class="tooltip">REFERENCE<div class="right"><b>compulsory keyword </b>
a pdb file containing the set of reference configurations <i></i></div></div>=file.pdb <div class="tooltip">TYPE<div class="right"><b>compulsory keyword ( default=OPTIMAL-FAST )</b>
the manner in which distances are calculated. <i></i></div></div>=OPTIMAL <div class="tooltip">LAMBDA<div class="right"><b>compulsory keyword ( default=0 )</b>
the value of the lambda parameter for paths <i></i></div></div>=500.0 <span style="display:none;" id="eg1p1">The PATH action with label <b>p1</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">p1.zpath</td><td>the distance from the path</td></tr><tr><td width="5%%">p1.spath</td><td>the position on the path</td></tr></table>
</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg1p1">p1.spath</b>,<b name="eg1p1">p1.zpath</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar <div class="tooltip">FMT<div class="right">the format that should be used to output real numbers <i></i></div></div>=%8.4f <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p>The reference frames in the path are defined in the pdb file shown below. In this frame each configuration in the path is separated by a line containing just the word END.</p>
<pre class="fragment">ATOM      1  CL  ALA     1      -3.171   0.295   2.045  1.00  1.00
ATOM      5  CLP ALA     1      -1.819  -0.143   1.679  1.00  1.00
ATOM      6  OL  ALA     1      -1.177  -0.889   2.401  1.00  1.00
ATOM      7  NL  ALA     1      -1.313   0.341   0.529  1.00  1.00
END
ATOM      1  CL  ALA     1      -3.175   0.365   2.024  1.00  1.00
ATOM      5  CLP ALA     1      -1.814  -0.106   1.685  1.00  1.00
ATOM      6  OL  ALA     1      -1.201  -0.849   2.425  1.00  1.00
ATOM      7  NL  ALA     1      -1.296   0.337   0.534  1.00  1.00
END
ATOM      1  CL  ALA     1      -2.990   0.383   2.277  1.00  1.00
ATOM      5  CLP ALA     1      -1.664  -0.085   1.831  1.00  1.00
ATOM      6  OL  ALA     1      -0.987  -0.835   2.533  1.00  1.00
ATOM      7  NL  ALA     1      -1.227   0.364   0.646  1.00  1.00
END
</pre><p>In the example below the path is defined using the values of two torsional angles (t1 and t2). In addition, the \(s\) and \(z\) are calculated using the geometric expressions described above rather than the algebraic expressions that are used by default.</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2t1" onclick='showPath("eg2","eg2t1")'>t1: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=5,7,9,15 <span style="display:none;" id="eg2t1">The TORSION action with label <b>t1</b> calculates a single scalar value</span>
<b name="eg2t2" onclick='showPath("eg2","eg2t2")'>t2: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=7,9,15,17 <span style="display:none;" id="eg2t2">The TORSION action with label <b>t2</b> calculates a single scalar value</span>
<b name="eg2pp" onclick='showPath("eg2","eg2pp")'>pp: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_a_t_h.html" style="color:green">PATH</a> <div class="tooltip">TYPE<div class="right"><b>compulsory keyword ( default=OPTIMAL-FAST )</b>
the manner in which distances are calculated. <i></i></div></div>=EUCLIDEAN <div class="tooltip">REFERENCE<div class="right"><b>compulsory keyword </b>
a pdb file containing the set of reference configurations <i></i></div></div>=epath.pdb <div class="tooltip">GPATH<div class="right">calculate the position on the path using trigonometry The final value can be referenced
using <em>label</em>.gpath. <i></i></div></div> <div class="tooltip">NOSPATH<div class="right">( default=off ) do not calculate the spath position <i></i></div></div> <div class="tooltip">NOZPATH<div class="right">( default=off ) do not calculate the zpath position <i></i></div></div> <span style="display:none;" id="eg2pp">The PATH action with label <b>pp</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">pp.gspath</td><td>the position on the path calculated using trigonometry</td></tr><tr><td width="5%%">pp.gzpath</td><td>the distance from the path calculated using trigonometry</td></tr></table>
</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2pp">pp.*</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
<p>Notice that the LAMBDA parameter is not required here as we are not calculating \(s\) and \(s\) using the algebraic formulas defined earlier. The positions of the frames in the path are defined in the file epath.pdb. An extract from this file looks as shown below.</p>
<pre class="fragment">REMARK ARG=t1,t2 t1=-4.25053  t2=3.88053
END
REMARK ARG=t1,t2 t1=-4.11     t2=3.75
END
REMARK ARG=t1,t2 t1=-3.96947  t2=3.61947
END
</pre><p>The remarks in this pdb file tell PLUMED the labels that are being used to define the position in the high dimensional space and the values that these arguments have at each point on the path.</p>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default the value of the calculated quantity can be referenced elsewhere in the input file by using the label of the action. Alternatively this Action can be used to calculate the following quantities by employing the keywords listed below. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> gspath </b> </td><td width="10%"><b> GPATH </b>  </td><td>the position on the path calculated using trigonometry   </td></tr>
<tr>
<td width="5%"><b> gzpath </b> </td><td width="10%"><b> GPATH </b>  </td><td>the distance from the path calculated using trigonometry   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> REFERENCE </b> </td><td>a pdb file containing the set of reference configurations   </td></tr>
<tr>
<td width="15%"><b> TYPE </b> </td><td>( default=OPTIMAL-FAST ) the manner in which distances are calculated. More information on the different metrics that are available in PLUMED can be found in the section of the manual on <a class="el" href="dists.html">Distances from reference configurations</a>   </td></tr>
<tr>
<td width="15%"><b> LAMBDA </b> </td><td>( default=0 ) the value of the lambda parameter for paths   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not use MPI   </td></tr>
<tr>
<td width="15%"><b> TIMINGS </b> </td><td>( default=off ) output information on the timings of the various parts of the calculation   </td></tr>
<tr>
<td width="15%"><b> DISABLE_CHECKS </b> </td><td>( default=off ) disable checks on reference input structures.   </td></tr>
<tr>
<td width="15%"><b> NOZPATH </b> </td><td>( default=off ) do not calculate the zpath position   </td></tr>
<tr>
<td width="15%"><b> NOSPATH </b> </td><td><p class="starttd">( default=off ) do not calculate the spath position  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> GPATH </b> </td><td>calculate the position on the path using trigonometry The final value can be referenced using <em>label</em>.gpath. You can use multiple instances of this keyword i.e. GPATH1, GPATH2, GPATH3... The corresponding values are then referenced using <em>label</em>.gpath-1, <em>label</em>.gpath-2, <em>label</em>.gpath-3...   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="_colvar.html">CV Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
