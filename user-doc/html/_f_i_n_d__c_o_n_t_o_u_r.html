<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: FIND_CONTOUR</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7b</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_f_i_n_d__c_o_n_t_o_u_r.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">FIND_CONTOUR </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Find an isocontour in a smooth function.</p>
<p>As discussed in the part of the manual on <a class="el" href="_analysis.html">Analysis</a> PLUMED contains a number of tools that allow you to calculate a function on a grid. The function on this grid might be a <a class="el" href="_h_i_s_t_o_g_r_a_m.html">HISTOGRAM</a> as a function of a few collective variables or it might be a phase field that has been calculated using <a class="el" href="_m_u_l_t_i_c_o_l_v_a_r_d_e_n_s.html">MULTICOLVARDENS</a>. If this function has one or two input arguments it is relatively straightforward to plot the function. If by contrast the data has a three or more dimensions it can be difficult to visualize.</p>
<p>This action provides one tool for visualizing these functions. It can be used to search for a set of points on a contour where the function takes a particular values. In other words, for the function \(f(x,y)\) this action would find a set of points \(\{x_c,y_c\}\) that have:</p>
<p class="formulaDsp">
\[ f(x_c,y_c) - c = 0 \]
</p>
<p>where \(c\) is some constant value that is specified by the user. The points on this contour are detected using a variant on the marching squares or marching cubes algorithm, which you can find information on here:</p>
<p><a href="https://en.wikipedia.org/wiki/Marching_squares">https://en.wikipedia.org/wiki/Marching_squares</a> <a href="https://en.wikipedia.org/wiki/Marching_cubes">https://en.wikipedia.org/wiki/Marching_cubes</a></p>
<p>As such, and unlike <a class="el" href="_f_i_n_d__c_o_n_t_o_u_r__s_u_r_f_a_c_e.html">FIND_CONTOUR_SURFACE</a> or <a class="el" href="_f_i_n_d__s_p_h_e_r_i_c_a_l__c_o_n_t_o_u_r.html">FIND_SPHERICAL_CONTOUR</a>, the function input to this action can have any dimension. Furthermore, the topology of the contour will be determined by the algorithm and does not need to be specified by the user.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The input below allows you to calculate something akin to a Willard-Chandler dividing surface <a class="el" href="citelist.html#CITEREF_wcsurface">[125]</a>. The simulation cell in this case contains a solid phase and a liquid phase. The Willard-Chandler surface is the surface that separates the parts of the box containing the solid from the parts containing the liquid. To compute the position of this surface the <a class="el" href="_f_c_c_u_b_i_c.html">FCCUBIC</a> symmetry function is calculated for each of the atoms in the system from on the geometry of the atoms in the first coordination sphere of each of the atoms. These quantities are then transformed using a switching function. This procedure generates a single number for each atom in the system and this quantity has a value of one for atoms that are in parts of the box that resemble the solid structure and zero for atoms that are in parts of the box that resemble the liquid. The position of a virtual atom is then computed using <a class="el" href="_c_e_n_t_e_r__o_f__m_u_l_t_i_c_o_l_v_a_r.html">CENTER_OF_MULTICOLVAR</a> and a phase field model is constructed using <a class="el" href="_m_u_l_t_i_c_o_l_v_a_r_d_e_n_s.html">MULTICOLVARDENS</a>. These procedure ensures that we have a continuous function that gives a measure of the average degree of solidness at each point in the simulation cell. The Willard-Chandler dividing surface is calculated by finding a a set of points at which the value of this phase field is equal to 0.5. This set of points is output to file called mycontour.dat. A new contour is found on every single step for each frame that is read in.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_u_n_i_t_s.html" style="color:green">UNITS</a> <div class="tooltip">NATURAL<div class="right">( default=off ) use natural units <i></i></div></div> <span style="display:none;" id="eg1">The UNITS action with label <b></b></span>
<b name="eg1fcc" onclick='showPath("eg1","eg1fcc")'>fcc: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_f_c_c_u_b_i_c.html" style="color:green">FCCUBIC</a> ...
   <div class="tooltip">SPECIES<div class="right">this keyword is used for colvars such as coordination number. <i></i></div></div>=1-96000 <div class="tooltip">SWITCH<div class="right">This keyword is used if you want to employ an alternative to the continuous switching
function defined above. <i></i></div></div>={CUBIC D_0=1.2 D_MAX=1.5}  
   <div class="tooltip">ALPHA<div class="right"><b>compulsory keyword ( default=3.0 )</b>
The alpha parameter of the angular function <i></i></div></div>=27 <div class="tooltip">PHI<div class="right"><b>compulsory keyword ( default=0.0 )</b>
The Euler rotational angle phi <i></i></div></div>=0.0 <div class="tooltip">THETA<div class="right"><b>compulsory keyword ( default=0.0 )</b>
The Euler rotational angle theta <i></i></div></div>=-1.5708 <div class="tooltip">PSI<div class="right"><b>compulsory keyword ( default=0.0 )</b>
The Euler rotational angle psi <i></i></div></div>=-2.35619 
...<span style="display:none;" id="eg1fcc">The FCCUBIC action with label <b>fcc</b></span>
<b name="eg1tfcc" onclick='showPath("eg1","eg1tfcc")'>tfcc: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_t_r_a_n_s_f_o_r_m__m_o_r_e.html" style="color:green">MTRANSFORM_MORE</a> <div class="tooltip">DATA<div class="right"><b>compulsory keyword </b>
The multicolvar that calculates the set of base quantities that we are interested
in <i></i></div></div>=<b name="eg1fcc">fcc</b> <div class="tooltip">LOWMEM<div class="right">( default=off ) lower the memory requirements <i></i></div></div> <div class="tooltip">SWITCH<div class="right">This keyword is used if you want to employ an alternative to the continuous switching
function defined above. <i></i></div></div>={SMAP R_0=0.5 A=8 B=8}  <span style="display:none;" id="eg1tfcc">The MTRANSFORM_MORE action with label <b>tfcc</b></span>
<b name="eg1center" onclick='showPath("eg1","eg1center")'>center: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_e_n_t_e_r__o_f__m_u_l_t_i_c_o_l_v_a_r.html" style="color:green">CENTER_OF_MULTICOLVAR</a> <div class="tooltip">DATA<div class="right"><b>compulsory keyword </b>
find the average value for a multicolvar <i></i></div></div>=<b name="eg1tfcc">tfcc</b> <span style="display:none;" id="eg1center">The CENTER_OF_MULTICOLVAR action with label <b>center</b> calculates the position of a virtual atom</span>
<b name="eg1dens" onclick='showPath("eg1","eg1dens")'>dens: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_u_l_t_i_c_o_l_v_a_r_d_e_n_s.html" style="color:green">MULTICOLVARDENS</a> ...
   <div class="tooltip">DATA<div class="right"><b>compulsory keyword </b>
the multicolvar which you would like to calculate the density profile for <i></i></div></div>=<b name="eg1tfcc">tfcc</b> <div class="tooltip">ORIGIN<div class="right">we will use the position of this atom as the origin. <i></i></div></div>=<b name="eg1center">center</b> <div class="tooltip">DIR<div class="right"><b>compulsory keyword </b>
the direction in which to calculate the density profile <i></i></div></div>=xyz 
   <div class="tooltip">NBINS<div class="right">the number of bins to use to represent the density profile <i></i></div></div>=80,80,80 <div class="tooltip">BANDWIDTH<div class="right"><b>compulsory keyword </b>
the bandwidths for kernel density estimation <i></i></div></div>=1.0,1.0,1.0 <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=1 <div class="tooltip">CLEAR<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which to clear all the accumulated data. <i></i></div></div>=1 
...<span style="display:none;" id="eg1dens">The MULTICOLVARDENS action with label <b>dens</b></span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_f_i_n_d__c_o_n_t_o_u_r.html" style="color:green">FIND_CONTOUR</a> <div class="tooltip">GRID<div class="right"><b>compulsory keyword </b>
the action that creates the input grid you would like to use <i></i></div></div>=<b name="eg1dens">dens</b> <div class="tooltip">CONTOUR<div class="right"><b>compulsory keyword </b>
the value we would like to draw the contour at in the space <i></i></div></div>=0.5 <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
file on which to output coordinates <i></i></div></div>=mycontour.xyz <span style="display:none;" id="eg1">The FIND_CONTOUR action with label <b></b></span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> STRIDE </b> </td><td>( default=1 ) the frequency with which the data should be collected and added to the quantity being averaged   </td></tr>
<tr>
<td width="15%"><b> CLEAR </b> </td><td>( default=0 ) the frequency with which to clear all the accumulated data. The default value of 0 implies that all the data will be used and that the grid will never be cleared   </td></tr>
<tr>
<td width="15%"><b> NORMALIZATION </b> </td><td>( default=true ) This controls how the data is normalized it can be set equal to true, false or ndata. The differences between these options are explained in the manual page for <a class="el" href="_h_i_s_t_o_g_r_a_m.html">HISTOGRAM</a>   </td></tr>
<tr>
<td width="15%"><b> GRID </b> </td><td>the action that creates the input grid you would like to use   </td></tr>
<tr>
<td width="15%"><b> CONTOUR </b> </td><td>the value we would like to draw the contour at in the space   </td></tr>
<tr>
<td width="15%"><b> BUFFER </b> </td><td>( default=0 ) number of buffer grid points around location where grid was found on last step. If this is zero the full grid is calculated on each step   </td></tr>
<tr>
<td width="15%"><b> FILE </b> </td><td>file on which to output coordinates   </td></tr>
<tr>
<td width="15%"><b> UNITS </b> </td><td>( default=PLUMED ) the units in which to print out the coordinates. PLUMED means internal PLUMED units   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not use MPI   </td></tr>
<tr>
<td width="15%"><b> LOWMEM </b> </td><td>( default=off ) lower the memory requirements   </td></tr>
<tr>
<td width="15%"><b> TIMINGS </b> </td><td><p class="starttd">( default=off ) output information on the timings of the various parts of the calculation  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> LOGWEIGHTS </b> </td><td>list of actions that calculates log weights that should be used to weight configurations when calculating averages   </td></tr>
<tr>
<td width="15%"><b> CONCENTRATION </b> </td><td>the concentration parameter for Von Mises-Fisher distributions   </td></tr>
<tr>
<td width="15%"><b> COMPONENT </b> </td><td>if your input is a vector field use this to specify the component of the input vector field for which you wish to use   </td></tr>
<tr>
<td width="15%"><b> PRECISION </b> </td><td>The number of digits in trajectory file   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_analysis.html">Analysis</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
