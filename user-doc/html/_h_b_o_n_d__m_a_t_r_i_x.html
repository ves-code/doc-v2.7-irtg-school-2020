<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: HBOND_MATRIX</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7b</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_h_b_o_n_d__m_a_t_r_i_x.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">HBOND_MATRIX </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the adjmat <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=adjmat . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Adjacency matrix in which two atoms are adjacent if there is a hydrogen bond between them.</p>
<p>As discussed in the section of the manual on <a class="el" href="contactmatrix.html">Exploiting contact matrices</a> a useful tool for developing complex collective variables is the notion of the so called adjacency matrix. An adjacency matrix is an \(N \times N\) matrix in which the \(i\)th, \(j\)th element tells you whether or not the \(i\)th and \(j\)th atoms/molecules from a set of \(N\) atoms/molecules are adjacent or not. These matrices can then be further analyzed using a number of other algorithms as is detailed in <a class="el" href="citelist.html#CITEREF_tribello-clustering">[115]</a>.</p>
<p>For this action the elements of the adjacency matrix are calculated using:</p>
<p class="formulaDsp">
\[ a_{ij} = \sigma_{oo}( |\mathbf{r}_{ij}| ) \sum_{k=1}^N \sigma_{oh}( |\mathbf{r}_{ik}| ) \sigma_{\theta}( \theta_{kij} ) \]
</p>
<p>This expression was derived by thinking about how to detect if there is a hydrogen bond between atoms \(i\) and \(j\). The notion is that if the hydrogen bond is present atoms \(i\) and \(j\) should be within a certain cutoff distance. In addition, there should be a hydrogen within a certain cutoff distance of atom \(i\) and this hydrogen should lie on or close to the vector connecting atoms \(i\) and \(j\). As such \(\sigma_{oo}( |\mathbf{r}_{ij}| )\) is a <a class="el" href="switchingfunction.html">switchingfunction</a> that acts on the modulus of the vector connecting atom \(i\) to atom \(j\). The sum over \(k\) then runs over all the hydrogen atoms that are specified using using HYDROGEN keyword. \(\sigma_{oh}(|\mathbf{r}_{ik}|)\) is a <a class="el" href="switchingfunction.html">switchingfunction</a> that acts on the modulus of the vector connecting atom \(i\) to atom \(k\) and \(\sigma_{\theta}(\theta_{kij})\) is a <a class="el" href="switchingfunction.html">switchingfunction</a> that acts on the angle between the vector connecting atoms \(i\) and \(j\) and the vector connecting atoms \(i\) and \(k\).</p>
<p>It is important to note that hydrogen bonds, unlike regular bonds, are asymmetric. In other words, the hydrogen atom does not sit at the mid point between the two other atoms in this three-center bond. As a result of this adjacency matrices calculated using <a class="el" href="_h_b_o_n_d__m_a_t_r_i_x.html">HBOND_MATRIX</a> are not symmetric like those calculated by <a class="el" href="_c_o_n_t_a_c_t__m_a_t_r_i_x.html">CONTACT_MATRIX</a>. One consequence of this fact is that the quantities found by performing <a class="el" href="_r_o_w_s_u_m_s.html">ROWSUMS</a> and <a class="el" href="_c_o_l_u_m_n_s_u_m_s.html">COLUMNSUMS</a> on a square <a class="el" href="_h_b_o_n_d__m_a_t_r_i_x.html">HBOND_MATRIX</a> are not the same as they would be if you performed <a class="el" href="_r_o_w_s_u_m_s.html">ROWSUMS</a> and <a class="el" href="_c_o_l_u_m_n_s_u_m_s.html">COLUMNSUMS</a> on a square <a class="el" href="_c_o_n_t_a_c_t__m_a_t_r_i_x.html">CONTACT_MATRIX</a>.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following input can be used to analyze the number of hydrogen bonds each of the oxygen atoms in a box of water participates in. Each water molecule can participate in a hydrogen bond in one of two ways. It can either donate one of its hydrogen atom to the neighboring oxygen or it can accept a bond between the hydrogen of a neighboring water molecule and its own oxygen. The input below allows you to output information on the number of hydrogen bonds each of the water molecules donates and accepts. This information is output in two xyz files which each contain five columns of data. The first four of these columns are a label for the atom and the x, y and z position of the oxygen. The last column is then the number of accepted/donated hydrogen bonds.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1mat" onclick='showPath("eg1","eg1mat")'>mat: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_h_b_o_n_d__m_a_t_r_i_x.html" style="color:green">HBOND_MATRIX</a> <div class="tooltip">ATOMS<div class="right">The list of atoms which can be part of a hydrogen bond. <i></i></div></div>=1-192:3 <div class="tooltip">HYDROGENS<div class="right">The list of hydrogen atoms that can form part of a hydrogen bond. <i></i></div></div>=2-192:3,3-192:3 <div class="tooltip">SWITCH<div class="right">The \ref switchingfunction that specifies how close a pair of atoms must be together
for there to be a hydrogen bond between them You can use multiple instances of this
keyword i.e. <i></i></div></div>={RATIONAL R_0=3.20}  <div class="tooltip">HSWITCH<div class="right">The \ref switchingfunction that specifies how close the hydrogen must be to the donor
atom of the hydrogen bond for it to be considered a hydrogen bond You can use multiple
instances of this keyword i.e. <i></i></div></div>={RATIONAL R_0=2.30}  <div class="tooltip">ASWITCH<div class="right">A \ref switchingfunction that is used to specify what the angle between the vector
connecting the donor atom to the acceptor atom and the vector connecting the donor
atom to the hydrogen must be in order for it considered to be a hydrogen bond You
can use multiple instances of this keyword i.e. <i></i></div></div>={RATIONAL R_0=0.167pi}  <div class="tooltip">SUM<div class="right">calculate the sum of all the quantities. <i></i></div></div> <span style="display:none;" id="eg1mat">The HBOND_MATRIX action with label <b>mat</b> calculates a single scalar value</span>
<b name="eg1rsums" onclick='showPath("eg1","eg1rsums")'>rsums: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_r_o_w_s_u_m_s.html" style="color:green">ROWSUMS</a> <div class="tooltip">MATRIX<div class="right"><b>compulsory keyword </b>
the action that calculates the adjacency matrix vessel we would like to analyze <i></i></div></div>=<b name="eg1mat">mat</b> <div class="tooltip">MEAN<div class="right">take the mean of these variables. <i></i></div></div> <span style="display:none;" id="eg1rsums">The ROWSUMS action with label <b>rsums</b> calculates a single scalar value</span>
<b name="eg1csums" onclick='showPath("eg1","eg1csums")'>csums: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_o_l_u_m_n_s_u_m_s.html" style="color:green">COLUMNSUMS</a> <div class="tooltip">MATRIX<div class="right"><b>compulsory keyword </b>
the action that calculates the adjacency matrix vessel we would like to analyze <i></i></div></div>=<b name="eg1mat">mat</b> <div class="tooltip">MEAN<div class="right">take the mean of these variables. <i></i></div></div> <span style="display:none;" id="eg1csums">The COLUMNSUMS action with label <b>csums</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_m_u_l_t_i_c_o_l_v_a_r.html" style="color:green">DUMPMULTICOLVAR</a> <div class="tooltip">DATA<div class="right"><b>compulsory keyword </b>
certain actions in plumed work by calculating a list of variables and summing over
them. <i></i></div></div>=<b name="eg1rsums">rsums</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
file on which to output coordinates <i></i></div></div>=donors.xyz <span style="display:none;" id="eg1">The DUMPMULTICOLVAR action with label <b></b></span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_m_u_l_t_i_c_o_l_v_a_r.html" style="color:green">DUMPMULTICOLVAR</a> <div class="tooltip">DATA<div class="right"><b>compulsory keyword </b>
certain actions in plumed work by calculating a list of variables and summing over
them. <i></i></div></div>=<b name="eg1csums">csums</b> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
file on which to output coordinates <i></i></div></div>=acceptors.xyz <span style="display:none;" id="eg1">The DUMPMULTICOLVAR action with label <b></b></span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>When the label of this action is used as the input for a second you are not referring to a scalar quantity as you are in regular collective variables. The label is used to reference the full set of quantities calculated by the action. This is usual when using <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a>. Generally when doing this the previously calculated multicolvar will be referenced using the DATA keyword rather than ARG.</p>
<p>This Action can be used to calculate the following scalar quantities directly. These quantities are calculated by employing the keywords listed below. These quantities can then be referenced elsewhere in the input file by using this Action's label followed by a dot and the name of the quantity. Some of them can be calculated multiple times with different parameters. In this case the quantities calculated can be referenced elsewhere in the input by using the name of the quantity followed by a numerical identifier e.g. <em>label</em>.lessthan-1, <em>label</em>.lessthan-2 etc. When doing this and, for clarity we have made it so that the user can set a particular label for each of the components. As such by using the LABEL keyword in the description of the keyword input you can customize the component name</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> sum </b> </td><td width="10%"><b> SUM </b>  </td><td>the sum of values   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ATOMS </b> </td><td>The list of atoms which can be part of a hydrogen bond. When this command is used the set of atoms that can donate a hydrogen bond is assumed to be the same as the set of atoms that can form hydrogen bonds. The atoms involved must be specified as a list of labels of <a class="el" href="mcolv.html">MultiColvar</a> or labels of a <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a> actions. If you would just like to use the atomic positions you can use a <a class="el" href="_d_e_n_s_i_t_y.html">DENSITY</a> command to specify a group of atoms. Specifying your atomic positions using labels of other <a class="el" href="mcolv.html">MultiColvar</a> or <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a> commands is useful, however, as you can then exploit a much wider variety of functions of the contact matrix as described in <a class="el" href="contactmatrix.html">Exploiting contact matrices</a>. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
<tr>
<td width="15%"><b> HYDROGENS </b> </td><td>The list of hydrogen atoms that can form part of a hydrogen bond. The atoms must be specified using a comma separated list, an index range or by using a <a class="el" href="_g_r_o_u_p.html">GROUP</a>. A list of hydrogen atoms is always required even if you specify the other atoms using DONORS and ACCEPTORS as described below.. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
</table>
<dl class="section user"><dt>Or alternatively by using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> DONORS </b> </td><td>The list of atoms which can donate a hydrogen bond. The atoms involved must be specified as a list of labels of <a class="el" href="mcolv.html">MultiColvar</a> or labels of a <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a> actions. If you would just like to use the atomic positions you can use a <a class="el" href="_d_e_n_s_i_t_y.html">DENSITY</a> command to specify a group of atoms. Specifying your atomic positions using labels of other <a class="el" href="mcolv.html">MultiColvar</a> or <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a> commands is useful, however, as you can then exploit a much wider variety of functions of the contact matrix as described in <a class="el" href="contactmatrix.html">Exploiting contact matrices</a>   </td></tr>
<tr>
<td width="15%"><b> ACCEPTORS </b> </td><td>The list of atoms which can accept a hydrogen bond. The atoms involved must be specified as a list of labels of <a class="el" href="mcolv.html">MultiColvar</a> or labels of a <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a> actions. If you would just like to use the atomic positions you can use a <a class="el" href="_d_e_n_s_i_t_y.html">DENSITY</a> command to specify a group of atoms. Specifying your atomic positions using labels of other <a class="el" href="mcolv.html">MultiColvar</a> or <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a> commands is useful, however, as you can then exploit a much wider variety of functions of the contact matrix as described in <a class="el" href="contactmatrix.html">Exploiting contact matrices</a>   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not use MPI   </td></tr>
<tr>
<td width="15%"><b> TIMINGS </b> </td><td>( default=off ) output information on the timings of the various parts of the calculation   </td></tr>
<tr>
<td width="15%"><b> HIGHMEM </b> </td><td><p class="starttd">( default=off ) use a more memory intensive version of this collective variable  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> SWITCH </b> </td><td>The <a class="el" href="switchingfunction.html">switchingfunction</a> that specifies how close a pair of atoms must be together for there to be a hydrogen bond between them You can use multiple instances of this keyword i.e. SWITCH1, SWITCH2, SWITCH3...   </td></tr>
<tr>
<td width="15%"><b> HSWITCH </b> </td><td>The <a class="el" href="switchingfunction.html">switchingfunction</a> that specifies how close the hydrogen must be to the donor atom of the hydrogen bond for it to be considered a hydrogen bond You can use multiple instances of this keyword i.e. HSWITCH1, HSWITCH2, HSWITCH3...   </td></tr>
<tr>
<td width="15%"><b> ASWITCH </b> </td><td>A <a class="el" href="switchingfunction.html">switchingfunction</a> that is used to specify what the angle between the vector connecting the donor atom to the acceptor atom and the vector connecting the donor atom to the hydrogen must be in order for it considered to be a hydrogen bond You can use multiple instances of this keyword i.e. ASWITCH1, ASWITCH2, ASWITCH3...   </td></tr>
<tr>
<td width="15%"><b> SUM </b> </td><td>calculate the sum of all the quantities. The final value can be referenced using <em>label</em>.sum. You can use multiple instances of this keyword i.e. SUM1, SUM2, SUM3... The corresponding values are then referenced using <em>label</em>.sum-1, <em>label</em>.sum-2, <em>label</em>.sum-3...   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="contactmatrix.html">Exploiting contact matrices</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
