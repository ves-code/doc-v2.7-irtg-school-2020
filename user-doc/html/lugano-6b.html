<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: Lugano tutorial: Binding of a ion and a dinucleotide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7b</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('lugano-6b.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Lugano tutorial: Binding of a ion and a dinucleotide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="lugano-6b-aim"></a>
Aims</h1>
<p>In this tutorial I will show you how you can use PLUMED and metadynamics to study the binding between a ion and a dinucleotide.</p>
<h1><a class="anchor" id="lugano-6b-lo"></a>
Objectives</h1>
<p>Once this tutorial is completed students will</p>
<ul>
<li>Know how to enhance binding between molecules using metadynamics.</li>
<li>Know how to analyze metadynamics simulations.</li>
<li>Know how to compute standard affinities.</li>
</ul>
<h1><a class="anchor" id="lugano-6b-resources"></a>
Resources</h1>
<p>The reference trajectory and other files can be obtained at this path </p><pre class="fragment">wget https://github.com/plumed/lugano2019/raw/master/lugano-6b.tgz
</pre><p>This tutorial has been tested on v2.5 but it should also work with other versions of PLUMED.</p>
<h1><a class="anchor" id="lugano-6b-intro"></a>
Introduction</h1>
<p>For this tutorial we will consider a practical application. The system is actually taken from <a class="el" href="citelist.html#CITEREF_cunha2017unraveling">[40]</a>. It is one of the simplest systems studied in that paper, namely a guanine dinucleotide monophosphate binding a Mg ion. This is a very simple binding event, but a very similar procedure might be used to study binding of a ligand on a protein. The reason why this exercise is particularly simple is that instead of the ligand we have a single ion, thus with no internal degree of freedom, and instead of a protein with a complex binding pocket we have a dinucleotide. We are also assuming to know which is the proper binding site, since we can easily guess that the most stable binding will happen on the phosphate.</p>
<p>Since running these simulations on your laptop would take too long, you will start with the output files obtained with a decently long simulation and analyze them.</p>
<dl class="section warning"><dt>Warning</dt><dd>The trajectory is too short (approx 20ns) to obtain converged results! To get statistically significant numbers, please run it longer.</dd></dl>
<p>Before continuing, please read carefully the <code>plumed.dat</code> file that was used to produce the simulation, since there you will find all the explanations about which variables were biased and how.</p>
<p>In case you want to do analysis with python, you can use the included <code>plumed_pandas.py</code> module, which is a preview of a feature that will be available in plumed 2.6. It requires pandas to be installed (use <code>conda install pandas</code>) and allows to extract columns from a COLVAR file by name. It works in this way: </p><pre class="fragment">&gt; import plumed_pandas
&gt; import matplotlib.pyplot as plt
&gt; df=plumed_pandas.read_as_pandas("COLVAR")
# shows the head of the file:
&gt; df.head()
# plot distance between Mg and phosphate
&gt; plt.plot(df["dp"][:],".")
# plot coordination number of Mg with water
&gt; plt.plot(df["cn"][:],".")
</pre><h1><a class="anchor" id="lugano-6b-exercises"></a>
Exercises</h1>
<h2><a class="anchor" id="lugano-6b-ex-1"></a>
Exercise 1: Computing the free energy as a function of the biased variables.</h2>
<p>As the title says, just compute the free-energy landscape as a function of the biased collective variable (namely, distance between the Mg ion and the phosphate and coordination number of the Mg ion with water oxygen atoms). You should just use <a class="el" href="sum_hills.html">sum_hills</a> with the usual options. In order to visualize the result with gnuplot you might use something like this:</p>
<pre class="fragment">gnuplot&gt; set pm3d map
gnuplot&gt; sp "fes.dat" u 1:2:3
</pre><p>You should obtain a plot similar to this one:</p>
<div class="image">
<img src="lugano-6b-fes.png" alt=""/>
<div class="caption">
Free energy as a function of distance from phosphate and coordination with water</div></div>
<h2><a class="anchor" id="lugano-6b-ex-2"></a>
Exercise 2: Visualizing the trajectory</h2>
<p>This exercise is optional and is not needed to continue with the next points. However, it is a very good idea to do it in order to have a better understanding of what the system is doing!</p>
<p>Beware that the periodic boundary conditions were broken. You can adjust them using PLUMED with an input like this one (please fill the gaps)</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-incomplete-yellow.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> <div class="tooltip">STRUCTURE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing a reference structure. <i></i></div></div>=conf.pdb <span style="display:none;" id="eg1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> <div class="tooltip">ENTITY0<div class="right">the atoms that make up a molecule that you wish to align. <i></i></div></div>=@nucleic <span style="display:none;" id="eg1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg1c" onclick='showPath("eg1","eg1c")'>c: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_c_e_n_t_e_r.html" style="color:green">CENTER</a> <div class="tooltip">ATOMS<div class="right">the list of atoms which are involved the virtual atom's definition. <i></i></div></div>=@nucleic <span style="display:none;" id="eg1c"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg1mg" onclick='showPath("eg1","eg1mg")'>mg: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_g_r_o_u_p.html" style="color:green">GROUP</a> <div class="tooltip">ATOMS<div class="right">the numerical indexes for the set of atoms in the group. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="color:blue"># find the serial number of the Mg ion </span><span style="display:none;" id="eg1mg"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_w_r_a_p_a_r_o_u_n_d.html" style="color:green">WRAPAROUND</a> <div class="tooltip">AROUND<div class="right">reference atoms. <i></i></div></div>=<b name="eg1c">c</b> <div class="tooltip">ATOMS<div class="right">wrapped atoms. <i></i></div></div>=<b name="eg1mg">mg</b> <span style="display:none;" id="eg1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># check documentation of WRAPAROUND!</span>
<span style="color:blue"># you should also know how many atoms make a water molecule</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_w_r_a_p_a_r_o_u_n_d.html" style="color:green">WRAPAROUND</a> <div class="tooltip">AROUND<div class="right">reference atoms. <i></i></div></div>=<b name="eg1c">c</b> <div class="tooltip">ATOMS<div class="right">wrapped atoms. <i></i></div></div>=@water <div class="tooltip">GROUPBY<div class="right"><b>compulsory keyword ( default=1 )</b>
group atoms so as not to break molecules <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># dump your trajectory</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_d_u_m_p_a_t_o_m_s.html" style="color:green">DUMPATOMS</a> <div class="tooltip">ATOMS<div class="right">the atom indices whose positions you would like to print out. <i></i></div></div>=@mdatoms <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
file on which to output coordinates; extension is automatically detected <i></i></div></div>=whole.xtc <span style="display:none;" id="eg1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># writing all atoms you will be able to reuse the same pdb for opening.</span>
<span style="color:blue"># e.g. vmd conf.pdb whole.xtc</span>
</pre>
<h2><a class="anchor" id="lugano-6b-ex-3"></a>
Exercise 3: Reweighting your free energy</h2>
<p>Now reweight your free energy and compute it as a function of:</p><ul>
<li>distance between Mg and phosphate</li>
<li>distance between Mg and geometric center of RNA</li>
<li>coordination number between Mg and water</li>
</ul>
<p>The free energy as a function of the distance between Mg and geometric center of RNA can be used to identify the bulk region. In order to do so, normalize it adding the correct entropic term \(k_BT\log d^2\), and find a region where the free energy is approximately constant to represent the bulk region. You can for instance use the following commands in gnuplot </p><pre class="fragment">gnuplot&gt; p "fes_dc" u 1:2 , "" u 1:($2+2.5*log($1**2))
</pre><p>Below you can find reference results</p>
<div class="image">
<img src="lugano-6b-ffdp.png" alt=""/>
<div class="caption">
Free energy as a function of distance between Mg and phosphate</div></div>
 <div class="image">
<img src="lugano-6b-ffdc.png" alt=""/>
<div class="caption">
Free energy as a function of distance between Mg and RNA center</div></div>
 <div class="image">
<img src="lugano-6b-ffcn.png" alt=""/>
<div class="caption">
Free energy as a function of coordination between Mg and water oxygens</div></div>
<p>Also try to compute conditional free energies:</p><ul>
<li>coordination number between Mg and water <em>assuming Mg is bound to phosphate</em>.</li>
<li>coordination number between Mg and water <em>assuming Mg is in the bulk</em>.</li>
</ul>
<p>A possible way to do so you can use <a class="el" href="_u_p_d_a_t_e__i_f.html">UPDATE_IF</a> to extract portions of trajectory such that the Mg is bound or unbound.</p>
<p>Below you can find reference results </p><div class="image">
<img src="lugano-6b-ffcnUB.png" alt=""/>
<div class="caption">
Free energy as a function of coordination between Mg and water oxygens, both for Mg bound and unbound</div></div>
<h2><a class="anchor" id="lugano-6b-ex-4"></a>
Exercise 4: Standard affinity</h2>
<p>Now use the weights that you computed in the previous exercise to compute the absolute binding affinity of the Mg to the phosphate. In order to do so you should compute the relative probability of seeing the Mg bound to the phosphate and in the bulk region and normalize to 1 mol/M concentration.</p>
<p>For instance, if you define bulk the region between 1.5 and 2.5 nm, you should divide the weight of the unbound state by a factor \( \frac{4\pi}{3}(2.5^3-1.5^3)/V_{mol} \) where \(V_{mol}=1.66 nm^3\) is the volume corresponding to the inverse of 1 mol/L concentration. The absolute binding affinity is then defined as \(-k_BT \log \frac{w_B}{w_U} \). You should obtain a value of approximately 50.4 kj/mol</p>
<dl class="section warning"><dt>Warning</dt><dd>The trajectory is too short (approx 20ns) to obtain converged results! To get statistically significant numbers, please run it longer. Also notice that the result might depend a lot on the used force field. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
