<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: LOGMFD</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7b</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_l_o_g_m_f_d.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">LOGMFD </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the logmfd <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=logmfd . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Used to perform LogMFD, LogPD, and TAMD/d-AFED.</p>
<h1><a class="anchor" id="LogMFD"></a>
LogMFD</h1>
<p>Consider a physical system of \(N_q\) particles, for which the Hamiltonian is given as</p>
<p class="formulaDsp">
\[ {H_{\rm MD}}\left( {\bf{\Gamma}} \right) = \sum\limits_{j = 1}^{{N_q}} {\frac{{{\bf{p}}_j^2}}{{2{m_j}}}} + \Phi \left( {\bf{q}} \right) \]
</p>
<p>where \({\bf q}_j\), \({\bf p}_j\) ( \(\bf{\Gamma}={\bf q},{\bf p}\)), and \(m_j\) are the position, momentum, and mass of particle \(j\) respectively, and \(\Phi\) is the potential energy function for \({\bf q}\). The free energy \(F({\bf X})\) as a function of a set of \(N\) collective variables (CVs) is given as</p>
<p class="formulaDsp">
\begin{eqnarray*} F\left( {{\bf X}} \right) &amp;=&amp; - {k_B}T\log \int {\exp \left[ { - \beta {H_{\rm MD}}} \right]\prod\limits_{i = 1}^N {\delta \left( {{s_i}\left( {{\bf q}} \right) - {X_i}} \right)} d{\bf{\Gamma }}} \\ &amp;\simeq&amp; - {k_B}T\log \int {\exp \left[ { - \beta \left\{ {{H_{\rm MD}} + \sum\limits_i^N {\frac{{{K_i}}}{2}{{\left( {{s_i}\left( {{\bf q}} \right) - {X_i}} \right)}^2}} } \right\}} \right]} d{\bf{\Gamma }} \end{eqnarray*}
</p>
<p>where \(\bf{s}\) are the CVs, \(k_B\) is Boltzmann constant, \(\beta=k_BT\), and \(K_i\) is the spring constant which is large enough to invoke</p>
<p class="formulaDsp">
\[ \delta \left( x \right) = \lim_{k \to \infty } \sqrt {\beta k/2\pi} \exp \left( -\beta kx^2/2 \right) \]
</p>
<p>In mean-force dynamics, \({\bf X}\) are treated as fictitious dynamical variables, which are associated with the following Hamiltonian,</p>
<p class="formulaDsp">
\[ {H_{\rm log}} = \sum\limits_{i = 1}^N {\frac{{P_{{X_i}}^2}}{{2{M_i}}} + \Psi \left( {{\bf X}} \right)} \]
</p>
<p>where \({P_{{X_i}}}\) and \(M_i\) are the momentum and mass of \(X_i\), respectively, and \(\Psi\) is the potential function for \({\bf X}\). We assume that \(\Psi\) is a functional of \(F({\bf X})\); \(Î¨[F({\bf X})]\). The simplest form of \(\Psi\) is \(\Psi = F({\bf X})\), which corresponds to TAMD/d-AFED <a class="el" href="citelist.html#CITEREF_AbramsJ2008">[1]</a>, <a class="el" href="citelist.html#CITEREF_Maragliano2006">[74]</a> (or the extended Lagrangian dynamics in the limit of the adiabatic decoupling between \(\bf{q}\) and \({\bf X}\)). In the case of LogMFD, the following form of \(\Psi\) is introduced <a class="el" href="citelist.html#CITEREF_MorishitaLogMFD">[80]</a>;</p>
<p class="formulaDsp">
\[ {\Psi _{\rm log}}\left( {{\bf X}} \right) = \gamma \log \left[ {\alpha F\left( {{\bf X}} \right) + 1} \right] \]
</p>
<p>where \(\alpha\) (ALPHA) and \(\gamma\) (GAMMA) are positive parameters. The logarithmic form of \(\Psi_{\rm log}\) ensures the dynamics of \({\bf X}\) on a much smoother energy surface [i.e., \(\Psi_{\rm log}({\bf X})\)] than \(F({\bf X})\), thus enhancing the sampling in the \({\bf X}\)-space. The parameters \(\alpha\) and \(\gamma\) determine the degree of flatness of \(\Psi_{\rm log}\), but adjusting only \(\alpha\) is normally sufficient to have a relatively flat surface (with keeping the relation \(\gamma=1/\alpha\)).</p>
<p>The equation of motion for \(X_i\) in LogMFD (no thermostat) is</p>
<p class="formulaDsp">
\[ {M_i}{\ddot X_i} = - \left( {\frac{{\alpha \gamma }}{{\alpha F + 1}}} \right)\frac{{\partial F}}{{\partial {X_i}}} \]
</p>
<p>where \(-\partial F/\partial X_i\) is evaluated as a canonical average under the condition that \({\bf X}\) is fixed;</p>
<p class="formulaDsp">
\begin{eqnarray*} - \frac{{\partial F}}{{\partial {X_i}}} &amp;\simeq&amp; \frac{1}{Z}\int {{K_i}\left( {{s_i}\left( {{\bf q}} \right) - {X_i}} \right)\exp \left[ { - \beta \left\{ {{H_{\rm MD}} + \sum\limits_i^N {\frac{{{K_i}}}{2}{{\left( {{s_i}\left( {{\bf q}} \right) - {X_i}} \right)}^2}} } \right\}} \right]} d{\bf{\Gamma }}\\ &amp;\equiv&amp; {\left\langle {{K_i}\left( {{s_i}\left( {{\bf q}} \right) - {X_i}} \right)} \right\rangle _{{\bf X}}} \end{eqnarray*}
</p>
<p>where</p>
<p class="formulaDsp">
\[ Z = \int {\exp \left[ { - \beta \left\{ {{H_{\rm MD}} + \sum\limits_i^N {\frac{{{K_i}}}{2}{{\left( {{s_i}\left( {{\bf q}} \right) - {X_i}} \right)}^2}} } \right\}} \right]} d{\bf{\Gamma }} \]
</p>
<p>The mean-force (MF) is practically evaluated by performing a shot-time canonical MD run each time \({\bf X}\) is updated according to the equation of motion for \({\bf X}\).</p>
<p>If the canonical average for the MF is effectively converged, the dynamical variables \({\bf q}\) and \({\bf X}\) are decoupled and they evolve adiabatically, which can be exploited for the on-the-fly evaluation of \(F({\bf X})\). I.e., \(H_{\rm log}\) should be a constant of motion in this case, thus \(F({\bf X})\) can be evaluated each time \({\bf X}\) is updated as</p>
<p class="formulaDsp">
\[ F\left( {{{\bf X}}\left( t \right)} \right) = \frac{1}{\alpha} \left[ \exp \frac{1}{\gamma} \left\{ \left( H_{\rm log} - \sum_i \frac{P_{X_i}^2}{2M_i} \right) \right\} - 1 \right] \]
</p>
<p>This means that \(F({\bf X})\) can be constructed without post processing (on-the-fly free energy reconstruction). Note that the on-the-fly free energy reconstruction is also possible in TAMD/d-AFED if the Hamiltonian-like conserved quantity is available (e.g., the Nose-Hoover type dynamics).</p>
<h1><a class="anchor" id="LogPD"></a>
LogPD</h1>
<p>The accuracy in the MF is critical to the on-the-fly free energy reconstruction. To improve the evaluation of the MF, parallel-dynamics (PD) is incorporated into LogMFD, leading to logarithmic parallel-dynamics (LogPD) <a class="el" href="citelist.html#CITEREF_MorishitaLogPD">[81]</a>.</p>
<p>In PD, the MF is evaluated by a non-equilibrium path-ensemble based on the Crooks-Jarzynski non-equilibrium work relation. To this end, multiple replicas of the MD system which run in parallel are introduced. The CVs [ \({\bf s}({\bf q})\)] in each replica is restrained to the same value of \({\bf X}(t)\). A canonical MD run with \(N_m\) steps is performed in each replica, then the MF on \(X_i\) is evaluated using the MD trajectories from all replicas. The MF is practically calculated as</p>
<p class="formulaDsp">
\[ - \frac{{\partial F}}{{\partial {X_i}}} = \sum\limits_{k = 1}^{{N_r}} {{W_k}} \sum\limits_{n = 1}^{{N_m}} {\frac{1}{{{N_m}}}{K_i}\left[ {{s_i}\left( {{{\bf q}}_n^k} \right) - {X_i}} \right]} \]
</p>
<p>where \({\bf q}^k_n\) indicates the \({\bf q}\)-configuration at time step \(n\) in the \(N_m\)-step shot-time MD run in the \(k\)th replica among \(N_r\) replicas. \(W_k\) is given as</p>
<p class="formulaDsp">
\[ {W_k} = \frac{{{e^{ - \beta {w_k}\left( t \right)}}}}{{\sum\limits_{k=1}^{{N_r}} {{e^{ - \beta {w_k}\left( t \right)}}} }} \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ {w_k}\left( t \right) = \int\limits_{{X_0}}^{X\left( t \right)} {\sum\limits_{i=1}^N {\frac{{\partial H_{\rm MD}^k}}{{\partial {X_i}}}d{X_i}} } \]
</p>
<p class="formulaDsp">
\[ H_{\rm MD}^k\left( {{\bf{\Gamma }},{{\bf X}}} \right) = {H_{\rm MD}}\left( {{{\bf{\Gamma }}^k}} \right) + \sum\limits_{i = 1}^N {\frac{{{K_i}}}{2}{{\left( {s_i^k - {X_i}} \right)}^2}} \]
</p>
<p>and \(s^k_i\) is the \(i\)th CV in the \(k\)th replica.</p>
<p>\(W_k\) comes from the Crooks-Jarzynski non-equilibrium work relation by which we can evaluate an equilibrium ensemble average from a set of non-equilibrium trajectories. Note that, to avoid possible numerical errors in the exponential function, the following form of \(W_k\) is instead used in PLUMED,</p>
<p class="formulaDsp">
\[ {W_k}\left( t \right) = \frac{{\exp \left[ { - \beta \left\{ {{w_k}\left( t \right) - {w_{\min }}\left( t \right)} \right\}} \right]}}{{\sum\nolimits_k {\exp \left[ { - \beta \left\{ {{w_k}\left( t \right) - {w_{\min }}\left( t \right)} \right\}} \right]} }} \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ {w_{\min }}\left( t \right) = {\rm Min}_k\left[ {{w_k}\left( t \right)} \right] \]
</p>
<p>With the MF evaluated using the PD approach, reconstructing free energy profiles can be performed more efficiently (requiring less elapsed computing time) in LogPD than with a single MD system in LogMFD. In the case that there exists more than one stable state separated by high energy barriers in the hidden subspace orthogonal to the CV-subspace, LogPD is particularly of use to incorporate all the contributions from such hidden states with appropriate weights (in the limit \(N_r\to\infty\) ).</p>
<p>Note that LogPD calculations should always be initiated with an equilibrium \({\bf q}\)-configuration in each replica, because the Crooks-Jarzynski non-equilibrium work relation is invoked. Also note that LogPD is currently available only with Gromacs, while LogMFD can be performed with LAMMPS, Gromacs, and NAMD.</p>
<h1><a class="anchor" id="Thermostat"></a>
Using LogMFD/PD with a thermostat</h1>
<p>Introducing a thermostat on \({\bf X}\) is often recommended in LogMFD/PD to maintain the adiabatic decoupling between \({\bf q}\) and \({\bf X}\). In the framework of the LogMFD approach, the Nose-Hoover type thermostat and the Gaussian isokinetic (velocity scaling) thermostat can be used to control the kinetic energy of \({\bf X}\).</p>
<h2><a class="anchor" id="Nose-Hoover"></a>
Nose-Hoover LogMFD/PD</h2>
<p>The equation of motion for \(X_i\) coupled to a Nose-Hoover thermostat variable \(\eta\) (single heat bath) is</p>
<p class="formulaDsp">
\[ {M_i}{\ddot X_i} = - \left( {\frac{{\alpha \gamma }}{{\alpha F + 1}}} \right)\frac{{\partial F}}{{\partial {X_i}}} - {M_i}{\dot X_i}\dot \eta \]
</p>
<p>The equation of motion for \(\eta\) is</p>
<p class="formulaDsp">
\[ Q\ddot \eta = \sum\limits_{i = 1}^N {\frac{{P_{{X_i}}^2}}{{{M_i}}} - N{k_B}T} \]
</p>
<p>where \(N\) is the number of the CVs. Since the following pseudo-Hamiltonian is a constant of motion in Nose-Hoover LogMFD/PD,</p>
<p class="formulaDsp">
\[ H_{\rm log}^{\rm NH} = \sum\limits_{i = 1}^N {\frac{{P_{{X_i}}^2}}{{2{M_i}}} + \gamma \log \left[ {\alpha F\left( {{\bf X}} \right) + 1} \right] + \frac{1}{2}Q{{\dot \eta }^2} + N{k_B}T\eta} \]
</p>
<p>\(F({\bf X}(t))\) is obtained at each MFD step as</p>
<p class="formulaDsp">
\[ F\left( {{{\bf X}}\left( t \right)} \right) = \frac{1}{\alpha }\left[ {\exp \left\{ {{{ \frac{1}{\gamma} \left( {H_{\rm log}^{\rm NH} - \sum_i {\frac{{P_{{X_i}}^2}}{{2{M_i}}}} - \frac{1}{2}Q{{\dot \eta }^2} - N{k_B}T\eta} \right)} }} \right\} - 1} \right] \]
</p>
<h2><a class="anchor" id="VS"></a>
Velocity scaling LogMFD/PD</h2>
<p>The velocity scaling algorithm (which is equivalent to the Gaussian isokinetic dynamics in the limit \(\Delta t\to 0\)) can also be employed to control the velocity of \({\bf X}\), \(\bf{V}_x\).</p>
<p>The following algorithm is introduced to perform isokinetic LogMFD calculations <a class="el" href="citelist.html#CITEREF_MorishitaVsLogMFD">[82]</a>;</p>
<p class="formulaDsp">
\begin{eqnarray*} {V_{{X_i}}}\left( {{t_{n + 1}}} \right) &amp;=&amp; V_{X_i}^\prime \left( {{t_n}} \right) + \Delta t\left[ { - \left( {\frac{{\alpha \gamma }}{{\alpha F\left( {{t_n}} \right) + 1}}} \right)\frac{{\partial F\left( {{t_n}} \right)}}{{\partial {X_i}}}} \right]\\ S\left( {{t_{n + 1}}} \right) &amp;=&amp; \sqrt {\frac{{N{k_B}T}}{{\sum\limits_i {{M_i}V_{{X_i}}^2\left( {{t_{n + 1}}} \right)} }}} \\ {V_{{X_i}}}^\prime \left( {{t_{n + 1}}} \right) &amp;=&amp; S\left( {{t_{n + 1}}} \right){V_{{X_i}}}\left( {{t_{n + 1}}} \right)\\ {X_i}\left( {{t_{n + 1}}} \right) &amp;=&amp; {X_i}\left( {{t_n}} \right) + \Delta t V_{X_i}^\prime \left( {{t_{n + 1}}} \right)\\ {\Psi_{\rm log}}\left( {{t_{n + 1}}} \right) &amp;=&amp; N{k_B}T\log S\left( {{t_{n + 1}}} \right) + {\Psi_{\rm log}}\left( {{t_n}} \right)\\ F\left( {{t_{n + 1}}} \right) &amp;=&amp; \frac{1}{\alpha} \left[ \exp \left\{ \Psi_{\rm log} \left( t_{n+1} \right) / \gamma \right\} - 1 \right] \end{eqnarray*}
</p>
<p>Note that \(V_{X_i}^\prime\left( {{t_0}} \right)\) is assumed to be initially given, which meets the following relation,</p>
<p class="formulaDsp">
\[ \sum\limits_{i = 1}^N M_i V_{X_i}^{\prime 2} \left( t_0 \right) = N{k_B}{T} \]
</p>
<p>It should be stressed that, in the same way as in the NVE and Nose-Hoover LogMFD/PD, \(F({\bf X}(t))\) can be evaluated at each MFD step (on-the-fly free energy reconstruction) in Velocity Scaling LogMFD/PD.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<h1><a class="anchor" id="Examples"></a>
Examples</h1>
<h2><a class="anchor" id="Example-LoGMFD"></a>
Example of LogMFD</h2>
<p>The following input file tells plumed to restrain collective variables to the fictitious dynamical variables in LogMFD/PD.</p>
<p>plumed.dat </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_u_n_i_t_s.html" style="color:green">UNITS</a> <div class="tooltip">TIME<div class="right">the units of time. <i></i></div></div>=fs <div class="tooltip">LENGTH<div class="right">the units of lengths. <i></i></div></div>=1.0 <div class="tooltip">ENERGY<div class="right">the units of energy. <i></i></div></div>=kcal/mol <div class="tooltip">MASS<div class="right">the units of masses. <i></i></div></div>=1.0 <div class="tooltip">CHARGE<div class="right">the units of charges. <i></i></div></div>=1.0 <span style="display:none;" id="eg1">The UNITS action with label <b></b></span>
<b name="eg1phi" onclick='showPath("eg1","eg1phi")'>phi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=5,7,9,15 <span style="display:none;" id="eg1phi">The TORSION action with label <b>phi</b> calculates a single scalar value</span>
<b name="eg1psi" onclick='showPath("eg1","eg1psi")'>psi: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=7,9,15,17 <span style="display:none;" id="eg1psi">The TORSION action with label <b>psi</b> calculates a single scalar value</span>
<span style="color:blue"># LogMFD</span>
<b name="eg1logmfd" onclick='showPath("eg1","eg1logmfd")'>logmfd: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_l_o_g_m_f_d.html" style="color:green">LOGMFD</a> ...
   
   <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg1phi">phi</b>,<b name="eg1psi">psi</b> 
   <div class="tooltip">KAPPA<div class="right"><b>compulsory keyword </b>
Spring constant of the harmonic restraining potential for the fictitious dynamical
variables. <i></i></div></div>=100.0,100.0 
   <div class="tooltip">DELTA_T<div class="right"><b>compulsory keyword </b>
Time step for the fictitious dynamical variables (MFD step). <i></i></div></div>=0.5 
   <div class="tooltip">INTERVAL<div class="right"><b>compulsory keyword </b>
Period of MD steps (\f$N_m\f$) to update fictitious dynamical variables. <i></i></div></div>=500 
   <div class="tooltip">TEMP<div class="right">Temperature of the fictitious dynamical variables in LogMFD/PD thermostat. <i></i></div></div>=300.0 
   <div class="tooltip">FLOG<div class="right"><b>compulsory keyword </b>
The initial free energy value in the LogMFD/PD run.The <i></i></div></div>=5.0 
   <div class="tooltip">MFICT<div class="right">Masses of each fictitious dynamical variable. <i></i></div></div>=5000000.0,5000000.0 
   <div class="tooltip">VFICT<div class="right">The initial velocities of the fictitious dynamical variables. <i></i></div></div>=3.5e-4,3.5e-4 
   <div class="tooltip">ALPHA<div class="right">Alpha parameter for LogMFD. <i></i></div></div>=4.0 
   <div class="tooltip">THERMOSTAT<div class="right"><b>compulsory keyword </b>
Type of thermostat for the fictitious dynamical variables. <i></i></div></div>=NVE 
   <div class="tooltip">VETA<div class="right">The initial velocity of eta variable. <i></i></div></div>=0.0 
   <div class="tooltip">META<div class="right">Mass of eta variable. <i></i></div></div>=20000.0 
   <div class="tooltip">FICT_MAX<div class="right"><b>compulsory keyword </b>
Maximum values reachable for the fictitious dynamical variables. <i></i></div></div>=3.1,3.1 
   <div class="tooltip">FICT_MIN<div class="right"><b>compulsory keyword </b>
Minimum values reachable for the fictitious dynamical variables. <i></i></div></div>=-3.1,-3.1 
...<span style="display:none;" id="eg1logmfd">The LOGMFD action with label <b>logmfd</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">logmfd.bias</td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%%">logmfd.phi_fict</td><td>For example, the fictitious collective variable for LogMFD is specified as ARG=dist12 and LABEL=logmfd in LOGMFD section in Plumed input file, the associated fictitious dynamical variable can be specified as PRINT ARG=dist12,logmfd.dist12_fict FILE=COLVAR This particular component measures this quantity for the input CV named phi</td></tr><tr><td width="5%%">logmfd.phi_vfict</td><td>For example, the fictitious collective variable for LogMFD is specified as ARG=dist12 and LABEL=logmfd in LOGMFD section in Plumed input file, the velocity of the associated fictitious dynamical variable can be specified as PRINT ARG=dist12,logmfd.dist12_vfict FILE=COLVAR This particular component measures this quantity for the input CV named phi</td></tr><tr><td width="5%%">logmfd.psi_fict</td><td>For example, the fictitious collective variable for LogMFD is specified as ARG=dist12 and LABEL=logmfd in LOGMFD section in Plumed input file, the associated fictitious dynamical variable can be specified as PRINT ARG=dist12,logmfd.dist12_fict FILE=COLVAR This particular component measures this quantity for the input CV named psi</td></tr><tr><td width="5%%">logmfd.psi_vfict</td><td>For example, the fictitious collective variable for LogMFD is specified as ARG=dist12 and LABEL=logmfd in LOGMFD section in Plumed input file, the velocity of the associated fictitious dynamical variable can be specified as PRINT ARG=dist12,logmfd.dist12_vfict FILE=COLVAR This particular component measures this quantity for the input CV named psi</td></tr></table>
</span>
</pre>
<p>To submit this simulation with Gromacs, use the following command line to execute a LogMFD run with Gromacs-MD. Here TOPO/topol0.tpr is an input file which contains atomic coordinates and Gromacs parameters.</p>
<pre class="fragment">gmx_mpi mdrun -s TOPO/topol0.tpr -plumed
</pre><p>This command will output files named logmfd.out and replica.out.</p>
<p>The output file logmfd.out records free energy and all fictitious dynamical variables at every MFD step.</p>
<p>logmfd.out</p>
<pre class="fragment"># LogMFD
# CVs : phi psi
# Mass for CV particles : 5000000.000000000 5000000.000000000
# Mass for thermostat   :   20000.000000000
# 1:iter_md, 2:Flog, 3:2*Ekin/gkb[K], 4:eta, 5:Veta,
# 6:phi_fict(t), 7:phi_vfict(t), 8:phi_force(t),
# 9:psi_fict(t), 10:psi_vfict(t), 11:psi_force(t),
       1       4.99918574     308.24149708       0.00000000       0.00000000      -2.85605938       0.00035002       5.19074544       2.79216364       0.00035000      -0.53762989
       2       4.99836196     308.26124159       0.00000000       0.00000000      -2.85588436       0.00035005       4.71247605       2.79233863       0.00035000      -0.00532474
       3       4.99743572     308.28344595       0.00000000       0.00000000      -2.85570932       0.00035007       5.34358230       2.79251363       0.00035000      -0.05119816
...
</pre><p>The output file replica.out records all collective variables at every MFD step.</p>
<p>replica.out</p>
<pre class="fragment"># Replica No. 0 of 1.
# 1:iter_md, 2:work, 3:weight,
# 4:phi(q)
# 5:psi(q)
       1   -8.142952e-04     1.000000e+00       -2.80432694       2.78661234
       2   -1.638105e-03     1.000000e+00       -2.80893462       2.79211039
       3   -2.564398e-03     1.000000e+00       -2.80244854       2.79182665
...
</pre><h2><a class="anchor" id="Example-LogPD"></a>
Example of LogPD</h2>
<p>Use the following command line to execute a LogPD run using two MD replicas (note that only Gromacs is currently available for LogPD). Here TOPO/topol0.tpr and TOPO/topol1.tpr are input files which contain atomic coordinates of each replica and Gromacs parameters.</p>
<pre class="fragment">mpirun -np 2 gmx_mpi mdrun -s TOPO/topol -plumed -multi 2
</pre><p>This command will output files named logmfd.out, replica.out.0 and replica.out.1.</p>
<p>The output file logmfd.out records free energy and all fictitious dynamical variables at every MFD step.</p>
<p>logmfd.out</p>
<pre class="fragment"># LogPD, replica parallel of LogMFD
# number of replica : 2
# CVs : phi psi
# Mass for CV particles : 5000000.000000000 5000000.000000000
# Mass for thermostat   :   20000.000000000
# 1:iter_md, 2:Flog, 3:2*Ekin/gkb[K], 4:eta, 5:Veta,
# 6:phi_fict(t), 7:phi_vfict(t), 8:phi_force(t),
# 9:psi_fict(t), 10:psi_vfict(t), 11:psi_force(t),
       1       5.00224715     308.16814691       0.00000000       0.00000000      -0.95937173       0.00034994     -12.91277494       0.78923967       0.00035000       0.07353010
       2       5.00476934     308.10774854       0.00000000       0.00000000      -0.95919679       0.00034989     -11.20093553       0.78941467       0.00034999      -3.21098229
       3       5.00702463     308.05376594       0.00000000       0.00000000      -0.95902187       0.00034983     -10.81712171       0.78958965       0.00034998      -2.07196718
...
</pre><p>The output file replica.out.0 records all collective variables of replica No.0 at every MFD step.</p>
<p>replica.out.0</p>
<pre class="fragment"># Replica No. 0 of 2.
# 1:iter_md, 2:work, 3:weight,
# 4:phi(q)
# 5:psi(q)
       1    1.843110e-03     5.003389e-01       -1.10929125       0.83348865
       2    3.466179e-03     5.010942e-01       -1.05020764       0.78731283
       3    4.927870e-03     5.017619e-01       -1.04968867       0.79635198
...
</pre><p>The output file replica.out.1 records all collective variables of replica No.1 at every MFD step.</p>
<p>replica.out.1</p>
<pre class="fragment"># Replica No. 1 of 2.
# 1:iter_md, 2:work, 3:weight,
# 4:phi(q)
# 5:psi(q)
       1    2.651173e-03     4.996611e-01       -1.06802968       0.74605205
       2    6.075530e-03     4.989058e-01       -1.09264741       0.72681448
       3    9.129358e-03     4.982381e-01       -1.08517238       0.74084241
...
</pre><dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
<tr>
<td width="15%"><b> _fict </b> </td><td>For example, the fictitious collective variable for LogMFD is specified as ARG=dist12 and LABEL=logmfd in LOGMFD section in Plumed input file, the associated fictitious dynamical variable can be specified as PRINT ARG=dist12,logmfd.dist12_fict FILE=COLVAR   </td></tr>
<tr>
<td width="15%"><b> _vfict </b> </td><td>For example, the fictitious collective variable for LogMFD is specified as ARG=dist12 and LABEL=logmfd in LOGMFD section in Plumed input file, the velocity of the associated fictitious dynamical variable can be specified as PRINT ARG=dist12,logmfd.dist12_vfict FILE=COLVAR   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> INTERVAL </b> </td><td>Period of MD steps ( \(N_m\)) to update fictitious dynamical variables.   </td></tr>
<tr>
<td width="15%"><b> DELTA_T </b> </td><td>Time step for the fictitious dynamical variables (MFD step).   </td></tr>
<tr>
<td width="15%"><b> THERMOSTAT </b> </td><td>Type of thermostat for the fictitious dynamical variables. NVE, NVT, VS are available.   </td></tr>
<tr>
<td width="15%"><b> KAPPA </b> </td><td>Spring constant of the harmonic restraining potential for the fictitious dynamical variables.   </td></tr>
<tr>
<td width="15%"><b> FICT_MAX </b> </td><td>Maximum values reachable for the fictitious dynamical variables. The variables will elastically bounce back at the boundary (mirror boundary).   </td></tr>
<tr>
<td width="15%"><b> FICT_MIN </b> </td><td>Minimum values reachable for the fictitious dynamical variables. The variables will elastically bounce back at the boundary (mirror boundary).   </td></tr>
<tr>
<td width="15%"><b> FLOG </b> </td><td>The initial free energy value in the LogMFD/PD run.The origin of the free energy profile is adjusted by FLOG to realize \(F({\bf X}(t)) &gt; 0\) at any \({\bf X}(t)\), resulting in enhanced barrier-crossing. (The value of \(H_{\rm log}\) is automatically set according to FLOG).   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td><p class="starttd">( default=off ) calculate the derivatives for these quantities numerically  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> ARG </b> </td><td>the input for this action is the scalar output from one or more other actions. The particular scalars that you will use are referenced using the label of the action. If the label appears on its own then it is assumed that the Action calculates a single scalar value. The value of this scalar is thus used as the input to this new action. If * or *.* appears the scalars calculated by all the proceeding actions in the input file are taken. Some actions have multi-component outputs and each component of the output has a specific label. For example a <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> action labelled dist may have three components x, y and z. To take just the x component you should use dist.x, if you wish to take all three components then use dist.*.More information on the referencing of Actions can be found in the section of the manual on the PLUMED <a class="el" href="_syntax.html">Getting Started</a>. Scalar values can also be referenced using POSIX regular expressions as detailed in the section on <a class="el" href="_regex.html">Regular Expressions</a>. To use this feature you you must compile PLUMED with the appropriate flag. You can use multiple instances of this keyword i.e. ARG1, ARG2, ARG3...   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>Temperature of the fictitious dynamical variables in LogMFD/PD thermostat. If not provided or provided as 0, it will be taken from the temperature of the MD system.   </td></tr>
<tr>
<td width="15%"><b> TAMD </b> </td><td>When TAMD=1, TAMD/d-AFED calculations can be performed instead of LogMFD. Otherwise, the LogMFD protocol is switched on (default).   </td></tr>
<tr>
<td width="15%"><b> ALPHA </b> </td><td>Alpha parameter for LogMFD. If not provided or provided as 0, it will be taken as 1/gamma. If gamma is also not provided, Alpha is set as 4, which is a sensible value when the unit of kcal/mol is used.   </td></tr>
<tr>
<td width="15%"><b> GAMMA </b> </td><td>Gamma parameter for LogMFD. If not provided or provided as 0, it will be taken as 1/alpha. If alpha is also not provided, Gamma is set as 0.25, which is a sensible value when the unit of kcal/mol is used.   </td></tr>
<tr>
<td width="15%"><b> FICT </b> </td><td>The initial values of the fictitious dynamical variables. If not provided, they are set equal to their corresponding CVs for the initial atomic configuration.   </td></tr>
<tr>
<td width="15%"><b> VFICT </b> </td><td>The initial velocities of the fictitious dynamical variables. If not provided, they will be taken as 0.   </td></tr>
<tr>
<td width="15%"><b> MFICT </b> </td><td>Masses of each fictitious dynamical variable. If not provided, they will be taken as 10000.   </td></tr>
<tr>
<td width="15%"><b> XETA </b> </td><td>The initial eta variable of the Nose-Hoover thermostat for the fictitious dynamical variables. If not provided, it will be taken as 0.   </td></tr>
<tr>
<td width="15%"><b> VETA </b> </td><td>The initial velocity of eta variable. If not provided, it will be taken as 0.   </td></tr>
<tr>
<td width="15%"><b> META </b> </td><td>Mass of eta variable. If not provided, it will be taken as \(N*kb*T*100*100\).   </td></tr>
<tr>
<td width="15%"><b> WORK </b> </td><td>The initial value of the work done by fictitious dynamical variables in each replica. If not provided, it will be taken as 0.   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_l_o_g_m_f_d_m_o_d.html">Logarithmic Mean Force Dynamics</a></li><li class="navelem"><a class="el" href="_l_o_g_m_f_d_m_o_d_bias.html">Biases Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
