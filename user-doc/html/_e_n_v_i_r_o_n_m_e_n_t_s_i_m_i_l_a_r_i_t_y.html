<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: ENVIRONMENTSIMILARITY</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7b</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_e_n_v_i_r_o_n_m_e_n_t_s_i_m_i_l_a_r_i_t_y.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ENVIRONMENTSIMILARITY </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the crystallization <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=crystallization . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Measure how similar the environment around atoms is to that found in some reference crystal structure.</p>
<p>This CV was introduced in this article <a class="el" href="citelist.html#CITEREF_Piaggi-JCP-2019">[91]</a>. The starting point for the definition of the CV is the local atomic density around an atom. We consider an environment \(\chi\) around this atom and we define the density by </p><p class="formulaDsp">
\[ \rho_{\chi}(\mathbf{r})=\sum\limits_{i\in\chi} \exp\left(- \frac{|\mathbf{r}_i-\mathbf{r}|^2} {2\sigma^2} \right), \]
</p>
<p> where \(i\) runs over the neighbors in the environment \(\chi\), \(\sigma\) is a broadening parameter, and \(\mathbf{r}_i\) are the coordinates of the neighbors relative to the central atom. We now define a reference environment or template \(\chi_0\) that contains \(n\) reference positions \(\{\mathbf{r}^0_1,...,\mathbf{r}^0_n\}\) that describe, for instance, the nearest neighbors in a given lattice. \(\sigma\) is set using the SIGMA keyword and \(\chi_0\) is chosen with the CRYSTAL_STRUCTURE keyword. If only the SPECIES keyword is given then the atoms defined there will be the central and neighboring atoms. If instead the SPECIESA and SPECIESB keywords are given then SPECIESA determines the central atoms and SPECIESB the neighbors.</p>
<p>The environments \(\chi\) and \(\chi_0\) are compared using the kernel, </p><p class="formulaDsp">
\[ k_{\chi_0}(\chi)= \int d\mathbf{r} \rho_{\chi}(\mathbf{r}) \rho_{\chi_0}(\mathbf{r}) . \]
</p>
<p> Combining the two equations above and performing the integration analytically we obtain, </p><p class="formulaDsp">
\[ k_{\chi_0}(\chi)= \sum\limits_{i\in\chi} \sum\limits_{j\in\chi_0} \pi^{3/2} \sigma^3 \exp\left(- \frac{|\mathbf{r}_i-\mathbf{r}^0_j|^2} {4\sigma^2} \right). \]
</p>
<p> The kernel is finally normalized, </p><p class="formulaDsp">
\[ \tilde{k}_{\chi_0}(\chi) = \frac{1}{n} \sum\limits_{i\in\chi} \sum\limits_{j\in\chi_0} \exp\left( - \frac{|\mathbf{r}_i-\mathbf{r}^0_j|^2} {4\sigma^2} \right), \]
</p>
<p> such that \(\tilde{k}_{\chi_0}(\chi_0) = 1\). The above kernel is computed for each atom in the SPECIES or SPECIESA keywords. This quantity is a multicolvar so you can compute it for multiple atoms using a single PLUMED action and then compute the average value for the atoms in your system, the number of atoms that have an \(\tilde{k}_{\chi_0}\) value that is more that some target and so on.</p>
<p>The kernel can be generalized to crystal structures described as a lattice with a basis of more than one atom. In this case there is more than one type of environment. We consider the case of \(M\) environments \(X = \chi_1,\chi_2,...,\chi_M\) and we define the kernel through a best match strategy: </p><p class="formulaDsp">
\[ \tilde{k}_X(\chi)= \frac{1}{\lambda} \log \left ( \sum\limits_{l=1}^{M}\exp \left (\lambda \: \tilde{k}_{\chi_l}(\chi) \right ) \right ). \]
</p>
<p> For a large enough \(\lambda\) this expression will select the largest \(\tilde{k}_{\chi_l}(\chi)\) with \(\chi_l \in X\). This approach can be used, for instance, to target the hexagonal closed packed (HCP keyword) or the diamond structure (DIAMOND keyword).</p>
<p>The CRYSTAL_STRUCTURE keyword can take the values SC (simple cubic), BCC (body centered cubic), FCC (face centered cubic), HCP (hexagonal closed pack), DIAMOND (cubic diamond), and CUSTOM (user defined). All options follow the same conventions as in the <a href="https://lammps.sandia.gov/doc/lattice.html">lattice command</a> of <a href="https://lammps.sandia.gov/">LAMMPS</a>. If a CRYSTAL_STRUCTURE other than CUSTOM is used, then the lattice constants have to be specified using the keyword LATTICE_CONSTANTS. One value has to be specified for SC, BCC, FCC, and DIAMOND and two values have to be set for HCP (a and c lattice constants in that order).</p>
<p>If the CUSTOM option is used then the reference environments have to be specified by the user. The reference environments are specified in pdb files containing the distance vectors from the central atom to the neighbors. Make sure your PDB file is correctly formatted as explained <a class="el" href="pdbreader.html">in this page</a> If only one reference environment is specified then the filename should be given as argument of the keyword REFERENCE. If instead several reference environments are given, then they have to be provided in separate pdb files and given as arguments of the keywords REFERENCE_1, REFERENCE_2, etc. If you have a reference crystal structure configuration you can use the <a href="https://mybinder.org/v2/gh/PabloPiaggi/EnvironmentFinder/master?urlpath=apps%2FApp.ipynb">Environment Finder</a> app to determine the reference environments that you should use.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following input calculates the ENVIRONMENTSIMILARITY kernel for 250 atoms in the system using the BCC atomic environment as target, and then calculates and prints the average value for this quantity.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1es" onclick='showPath("eg1","eg1es")'>es: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_e_n_v_i_r_o_n_m_e_n_t_s_i_m_i_l_a_r_i_t_y.html" style="color:green">ENVIRONMENTSIMILARITY</a> <div class="tooltip">SPECIES<div class="right">this keyword is used for colvars such as coordination number. <i></i></div></div>=1-250 <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword ( default=0.1 )</b>
Broadening parameter <i></i></div></div>=0.05 <div class="tooltip">LATTICE_CONSTANTS<div class="right">Lattice constants. <i></i></div></div>=0.423 <div class="tooltip">CRYSTAL_STRUCTURE<div class="right"><b>compulsory keyword ( default=FCC )</b>
Targeted crystal structure. <i></i></div></div>=BCC <div class="tooltip">MEAN<div class="right">take the mean of these variables. <i></i></div></div> <span style="display:none;" id="eg1es">The ENVIRONMENTSIMILARITY action with label <b>es</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg1es">es.mean</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p>The next example compares the environments of the 96 selected atoms with a user specified reference environment. The reference environment is contained in the env1.pdb file. Once the kernel is computed the average and the number of atoms with a kernel larger than 0.5 are computed.</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2es" onclick='showPath("eg2","eg2es")'>es: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_e_n_v_i_r_o_n_m_e_n_t_s_i_m_i_l_a_r_i_t_y.html" style="color:green">ENVIRONMENTSIMILARITY</a> ...
   <div class="tooltip">SPECIES<div class="right">this keyword is used for colvars such as coordination number. <i></i></div></div>=1-288:3 
   <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword ( default=0.1 )</b>
Broadening parameter <i></i></div></div>=0.05 
   <div class="tooltip">CRYSTAL_STRUCTURE<div class="right"><b>compulsory keyword ( default=FCC )</b>
Targeted crystal structure. <i></i></div></div>=CUSTOM 
   <div class="tooltip">REFERENCE<div class="right">PDB file with relative distances from central atom. <i></i></div></div>=env1.pdb 
   
   <div class="tooltip">MEAN<div class="right">take the mean of these variables. <i></i></div></div> 
   <div class="tooltip">MORE_THAN<div class="right">calculate the number of variables more than a certain target value. <i></i></div></div>={RATIONAL R_0=0.5 NN=12 MM=24}  
...<span style="display:none;" id="eg2es">The ENVIRONMENTSIMILARITY action with label <b>es</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">es.mean</td><td>the mean value. The output component can be referred to elsewhere in the input file by using the label.mean</td></tr><tr><td width="5%%">es.morethan</td><td>the number of values more than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.</td></tr></table>
</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2es">es.mean</b>,<b name="eg2es">es.morethan</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
<p>The next example is similar to the one above but in this case 4 reference environments are specified. Each reference environment is given in a separate pdb file.</p>

<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.7-passing-green.svg" alt="tested on v2.7" /></div><pre style="width: 97%;" class="fragment">
<b name="eg3es" onclick='showPath("eg3","eg3es")'>es: </b><a href="https://www.plumed.org/doc-v2.7/user-doc/html/_e_n_v_i_r_o_n_m_e_n_t_s_i_m_i_l_a_r_i_t_y.html" style="color:green">ENVIRONMENTSIMILARITY</a> ...
   <div class="tooltip">SPECIES<div class="right">this keyword is used for colvars such as coordination number. <i></i></div></div>=1-288:3 
   <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword ( default=0.1 )</b>
Broadening parameter <i></i></div></div>=0.05 
   <div class="tooltip">CRYSTAL_STRUCTURE<div class="right"><b>compulsory keyword ( default=FCC )</b>
Targeted crystal structure. <i></i></div></div>=CUSTOM 
   <div class="tooltip">REFERENCE_1<div class="right">PDB files with relative distances from central atom. <i></i></div></div>=env1.pdb 
   <div class="tooltip">REFERENCE_2<div class="right">PDB files with relative distances from central atom. <i></i></div></div>=env2.pdb 
   <div class="tooltip">REFERENCE_3<div class="right">PDB files with relative distances from central atom. <i></i></div></div>=env3.pdb 
   <div class="tooltip">REFERENCE_4<div class="right">PDB files with relative distances from central atom. <i></i></div></div>=env4.pdb 
   
   <div class="tooltip">MEAN<div class="right">take the mean of these variables. <i></i></div></div> 
   <div class="tooltip">MORE_THAN<div class="right">calculate the number of variables more than a certain target value. <i></i></div></div>={RATIONAL R_0=0.5 NN=12 MM=24}  
...<span style="display:none;" id="eg3es">The ENVIRONMENTSIMILARITY action with label <b>es</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">es.mean</td><td>the mean value. The output component can be referred to elsewhere in the input file by using the label.mean</td></tr><tr><td width="5%%">es.morethan</td><td>the number of values more than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.</td></tr></table>
</span>
<a href="https://www.plumed.org/doc-v2.7/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg3es">es.mean</b>,<b name="eg3es">es.morethan</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg3">The PRINT action with label <b></b></span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>When the label of this action is used as the input for a second you are not referring to a scalar quantity as you are in regular collective variables. The label is used to reference the full set of quantities calculated by the action. This is usual when using <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a>. Generally when doing this the previously calculated multicolvar will be referenced using the DATA keyword rather than ARG.</p>
<p>This Action can be used to calculate the following scalar quantities directly. These quantities are calculated by employing the keywords listed below. These quantities can then be referenced elsewhere in the input file by using this Action's label followed by a dot and the name of the quantity. Some of them can be calculated multiple times with different parameters. In this case the quantities calculated can be referenced elsewhere in the input by using the name of the quantity followed by a numerical identifier e.g. <em>label</em>.lessthan-1, <em>label</em>.lessthan-2 etc. When doing this and, for clarity we have made it so that the user can set a particular label for each of the components. As such by using the LABEL keyword in the description of the keyword input you can customize the component name</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> altmin </b> </td><td width="10%"><b> ALT_MIN </b>  </td><td>the minimum value. This is calculated using the formula described in the description of the keyword so as to make it continuous.   </td></tr>
<tr>
<td width="5%"><b> between </b> </td><td width="10%"><b> BETWEEN </b>  </td><td>the number/fraction of values within a certain range. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
<tr>
<td width="5%"><b> highest </b> </td><td width="10%"><b> HIGHEST </b>  </td><td>the highest of the quantities calculated by this action   </td></tr>
<tr>
<td width="5%"><b> lessthan </b> </td><td width="10%"><b> LESS_THAN </b>  </td><td>the number of values less than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
<tr>
<td width="5%"><b> lowest </b> </td><td width="10%"><b> LOWEST </b>  </td><td>the lowest of the quantities calculated by this action   </td></tr>
<tr>
<td width="5%"><b> max </b> </td><td width="10%"><b> MAX </b>  </td><td>the maximum value. This is calculated using the formula described in the description of the keyword so as to make it continuous.   </td></tr>
<tr>
<td width="5%"><b> mean </b> </td><td width="10%"><b> MEAN </b>  </td><td>the mean value. The output component can be referred to elsewhere in the input file by using the label.mean   </td></tr>
<tr>
<td width="5%"><b> min </b> </td><td width="10%"><b> MIN </b>  </td><td>the minimum value. This is calculated using the formula described in the description of the keyword so as to make it continuous.   </td></tr>
<tr>
<td width="5%"><b> moment </b> </td><td width="10%"><b> MOMENTS </b>  </td><td>the central moments of the distribution of values. The second moment would be referenced elsewhere in the input file using <em>label</em>.moment-2, the third as <em>label</em>.moment-3, etc.   </td></tr>
<tr>
<td width="5%"><b> morethan </b> </td><td width="10%"><b> MORE_THAN </b>  </td><td>the number of values more than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SPECIES </b> </td><td>this keyword is used for colvars such as coordination number. In that context it specifies that plumed should calculate one coordination number for each of the atoms specified. Each of these coordination numbers specifies how many of the other specified atoms are within a certain cutoff of the central atom. You can specify the atoms here as another multicolvar action or using a MultiColvarFilter or ActionVolume action. When you do so the quantity is calculated for those atoms specified in the previous multicolvar. This is useful if you would like to calculate the Steinhardt parameter for those atoms that have a coordination number more than four for example   </td></tr>
</table>
<dl class="section user"><dt>Or alternatively by using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SPECIESA </b> </td><td>this keyword is used for colvars such as the coordination number. In that context it species that plumed should calculate one coordination number for each of the atoms specified in SPECIESA. Each of these coordination numbers specifies how many of the atoms specifies using SPECIESB is within the specified cutoff. As with the species keyword the input can also be specified using the label of another multicolvar   </td></tr>
<tr>
<td width="15%"><b> SPECIESB </b> </td><td>this keyword is used for colvars such as the coordination number. It must appear with SPECIESA. For a full explanation see the documentation for that keyword   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SIGMA </b> </td><td>( default=0.1 ) Broadening parameter   </td></tr>
<tr>
<td width="15%"><b> CRYSTAL_STRUCTURE </b> </td><td>( default=FCC ) Targeted crystal structure. Options are: SC: simple cubic, BCC: body center cubic, FCC: face centered cubic, HCP: hexagonal closed pack, DIAMOND: cubic diamond, CUSTOM: user defined   </td></tr>
<tr>
<td width="15%"><b> LAMBDA </b> </td><td>( default=100 ) Lambda parameter   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not use MPI   </td></tr>
<tr>
<td width="15%"><b> LOWMEM </b> </td><td>( default=off ) lower the memory requirements   </td></tr>
<tr>
<td width="15%"><b> TIMINGS </b> </td><td><p class="starttd">( default=off ) output information on the timings of the various parts of the calculation  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> LATTICE_CONSTANTS </b> </td><td>Lattice constants. Two comma separated values for HCP, one value for all other CRYSTAL_STRUCTURES.   </td></tr>
<tr>
<td width="15%"><b> REFERENCE </b> </td><td>PDB file with relative distances from central atom. Use this keyword if you are targeting a single reference environment.   </td></tr>
<tr>
<td width="15%"><b> REFERENCE_ </b> </td><td>PDB files with relative distances from central atom. Each file corresponds to one template. Use these keywords if you are targeting more than one reference environment. You can use multiple instances of this keyword i.e. REFERENCE_1, REFERENCE_2, REFERENCE_3...   </td></tr>
<tr>
<td width="15%"><b> MEAN </b> </td><td>take the mean of these variables. The final value can be referenced using <em>label</em>.mean. You can use multiple instances of this keyword i.e. MEAN1, MEAN2, MEAN3... The corresponding values are then referenced using <em>label</em>.mean-1, <em>label</em>.mean-2, <em>label</em>.mean-3...   </td></tr>
<tr>
<td width="15%"><b> MORE_THAN </b> </td><td>calculate the number of variables more than a certain target value. This quantity is calculated using \(\sum_i 1.0 - \sigma(s_i)\), where \(\sigma(s)\) is a <a class="el" href="switchingfunction.html">switchingfunction</a>. The final value can be referenced using <em>label</em>.morethan. You can use multiple instances of this keyword i.e. MORE_THAN1, MORE_THAN2, MORE_THAN3... The corresponding values are then referenced using <em>label</em>.morethan-1, <em>label</em>.morethan-2, <em>label</em>.morethan-3...   </td></tr>
<tr>
<td width="15%"><b> LESS_THAN </b> </td><td>calculate the number of variables less than a certain target value. This quantity is calculated using \(\sum_i \sigma(s_i)\), where \(\sigma(s)\) is a <a class="el" href="switchingfunction.html">switchingfunction</a>. The final value can be referenced using <em>label</em>.lessthan. You can use multiple instances of this keyword i.e. LESS_THAN1, LESS_THAN2, LESS_THAN3... The corresponding values are then referenced using <em>label</em>.lessthan-1, <em>label</em>.lessthan-2, <em>label</em>.lessthan-3...   </td></tr>
<tr>
<td width="15%"><b> MAX </b> </td><td>calculate the maximum value. To make this quantity continuous the maximum is calculated using \( \textrm{max} = \beta \log \sum_i \exp\left( \frac{s_i}{\beta}\right) \) The value of \(\beta\) in this function is specified using (BETA= \(\beta\)) The final value can be referenced using <em>label</em>.max. You can use multiple instances of this keyword i.e. MAX1, MAX2, MAX3... The corresponding values are then referenced using <em>label</em>.max-1, <em>label</em>.max-2, <em>label</em>.max-3...   </td></tr>
<tr>
<td width="15%"><b> MIN </b> </td><td>calculate the minimum value. To make this quantity continuous the minimum is calculated using \( \textrm{min} = \frac{\beta}{ \log \sum_i \exp\left( \frac{\beta}{s_i} \right) } \) The value of \(\beta\) in this function is specified using (BETA= \(\beta\)) The final value can be referenced using <em>label</em>.min. You can use multiple instances of this keyword i.e. MIN1, MIN2, MIN3... The corresponding values are then referenced using <em>label</em>.min-1, <em>label</em>.min-2, <em>label</em>.min-3...   </td></tr>
<tr>
<td width="15%"><b> BETWEEN </b> </td><td>calculate the number of values that are within a certain range. These quantities are calculated using kernel density estimation as described on <a class="el" href="histogrambead.html">histogrambead</a>. The final value can be referenced using <em>label</em>.between. You can use multiple instances of this keyword i.e. BETWEEN1, BETWEEN2, BETWEEN3... The corresponding values are then referenced using <em>label</em>.between-1, <em>label</em>.between-2, <em>label</em>.between-3...   </td></tr>
<tr>
<td width="15%"><b> HISTOGRAM </b> </td><td>calculate how many of the values fall in each of the bins of a histogram. This shortcut allows you to calculates NBIN quantities like BETWEEN. The final value can be referenced using <em>label</em>.histogram. You can use multiple instances of this keyword i.e. HISTOGRAM1, HISTOGRAM2, HISTOGRAM3... The corresponding values are then referenced using <em>label</em>.histogram-1, <em>label</em>.histogram-2, <em>label</em>.histogram-3...   </td></tr>
<tr>
<td width="15%"><b> MOMENTS </b> </td><td>calculate the moments of the distribution of collective variables. The mth moment of a distribution is calculated using \(\frac{1}{N} \sum_{i=1}^N ( s_i - \overline{s} )^m \), where \(\overline{s}\) is the average for the distribution. The moments keyword takes a lists of integers as input or a range. Each integer is a value of \(m\). The final calculated values can be referenced using moment- \(m\). You can use the COMPONENT keyword in this action but the syntax is slightly different. If you would like the second and third moments of the third component you would use MOMENTS={COMPONENT=3 MOMENTS=2-3}. The moments would then be referred to using the labels moment-3-2 and moment-3-3. This syntax is also required if you are using numbered MOMENT keywords i.e. MOMENTS1, MOMENTS2...   </td></tr>
<tr>
<td width="15%"><b> ALT_MIN </b> </td><td>calculate the minimum value. To make this quantity continuous the minimum is calculated using \( \textrm{min} = -\frac{1}{\beta} \log \sum_i \exp\left( -\beta s_i \right) \) The value of \(\beta\) in this function is specified using (BETA= \(\beta\)). The final value can be referenced using <em>label</em>.altmin. You can use multiple instances of this keyword i.e. ALT_MIN1, ALT_MIN2, ALT_MIN3... The corresponding values are then referenced using <em>label</em>.altmin-1, <em>label</em>.altmin-2, <em>label</em>.altmin-3...   </td></tr>
<tr>
<td width="15%"><b> LOWEST </b> </td><td>this flag allows you to recover the lowest of these variables. The final value can be referenced using <em>label</em>.lowest   </td></tr>
<tr>
<td width="15%"><b> HIGHEST </b> </td><td>this flag allows you to recover the highest of these variables. The final value can be referenced using <em>label</em>.highest   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="mcolv.html">MultiColvar</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
